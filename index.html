<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TT World - Goa Trip</title>
<!-- Font Awesome for Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  body {
    margin: 0;
    font-family: "Poppins", sans-serif;
    /* NEW GOA SUNSET GRADIENT */
    background: linear-gradient(135deg, #fbd786, #f7797d, #c471f5);
    padding: 0;
    overflow-x: hidden; /* Keep horizontal scroll hidden, allow vertical */
    min-height: 100vh;
    position: relative;
  }

  /* --- NEW ANIMATED BACKGROUND ICONS --- */
  .icons {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Behind everything */
    pointer-events: none;
    overflow: hidden;
  }

  .icons i {
    position: absolute;
    color: rgba(255, 255, 255, 0.12);
    animation: moveSide 20s linear infinite;
  }

  /* Each icon has its own starting LEFT */
  .icons i:nth-child(1)  { top: 5%;  left: -10%; font-size: 50px; animation-duration: 18s; }
  .icons i:nth-child(2)  { top: 15%; left: -30%; font-size: 45px; animation-duration: 22s; }
  .icons i:nth-child(3)  { top: 25%; left: -50%; font-size: 60px; animation-duration: 20s; }
  .icons i:nth-child(4)  { top: 35%; left: -70%; font-size: 48px; animation-duration: 24s; }
  .icons i:nth-child(5)  { top: 45%; left: -20%; font-size: 55px; animation-duration: 19s; }
  .icons i:nth-child(6)  { top: 55%; left: -40%; font-size: 50px; animation-duration: 26s; }
  .icons i:nth-child(7)  { top: 65%; left: -60%; font-size: 65px; animation-duration: 21s; }
  .icons i:nth-child(8)  { top: 75%; left: -80%; font-size: 45px; animation-duration: 23s; }
  .icons i:nth-child(9)  { top: 85%; left: -15%; font-size: 58px; animation-duration: 20s; }
  .icons i:nth-child(10) { top: 10%; left: -35%; font-size: 42px; animation-duration: 25s; }
  .icons i:nth-child(11) { top: 30%; left: -55%; font-size: 52px; animation-duration: 18s; }
  .icons i:nth-child(12) { top: 50%; left: -75%; font-size: 47px; animation-duration: 22s; }
  .icons i:nth-child(13) { top: 70%; left: -25%; font-size: 63px; animation-duration: 19s; }
  .icons i:nth-child(14) { top: 20%; left: -45%; font-size: 44px; animation-duration: 24s; }
  .icons i:nth-child(15) { top: 80%; left: -65%; font-size: 56px; animation-duration: 21s; }

  @keyframes moveSide {
    from { transform: translateX(0) rotate(0deg); }
    to   { transform: translateX(140vw) rotate(360deg); }
  }
  /* --- END BACKGROUND --- */

  /* --- IMAGE POPUP MODAL --- */
  .image-popup-modal {
    display: none;
    position: fixed;
    z-index: 3000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.85);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .image-popup-modal.active {
    display: flex;
    opacity: 1;
  }
  .popup-close {
    position: absolute;
    top: 20px;
    right: 30px;
    color: white;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
    z-index: 3001;
  }
  .popup-close:hover { color: #007acc; }
  
  .popup-image-content {
    max-width: 90%;
    max-height: 80%;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(255,255,255,0.2);
    object-fit: contain;
  }
  .popup-caption {
    color: #fff;
    margin-top: 15px;
    font-size: 1.5rem;
    text-align: center;
  }
  /* --- END IMAGE POPUP --- */

  /* HEADER */
  header.tt-header {
    background-color: #007acc;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 25px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1100;
    background: rgba(0, 122, 204, 0.95);
    backdrop-filter: blur(10px);
  }
  .logo-section { display: flex; align-items: center; gap: 15px; }
  .logo { width: 50px; height: 50px; object-fit: contain; border-radius: 10px; background: white; padding: 5px; }
  .site-title { font-size: 1.6rem; margin: 0; font-weight: 600; letter-spacing: 1px; }
  .hamburger { font-size: 26px; cursor: pointer; padding: 8px 12px; background: #005fa3; color: white; border: none; border-radius: 6px; }
  .sidebar { position: fixed; left: -250px; top: 70px; height: calc(100% - 70px); width: 250px; background: rgba(0, 58, 120, 0.98); color: white; transition: all 0.3s ease; padding-top: 10px; box-shadow: 3px 0 10px rgba(0,0,0,0.2); z-index: 1000; }
  .sidebar.active { left: 0; }
  .sidebar a { display: block; padding: 15px 25px; color: white; text-decoration: none; font-size: 16px; }
  .sidebar a:hover { background: #0056a3; }
  .main { padding: 100px 25px; transition: margin-left 0.3s; position: relative; z-index: 1; }
  .sidebar.active ~ .main { margin-left: 250px; }
  .trip-section { display: flex; justify-content: center; margin-top: 40px; }
  .trip-card { background: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; width: 260px; transition: transform 0.3s; }
  .trip-card:hover { transform: translateY(-5px); }
  .trip-card img { width: 100%; height: 150px; object-fit: cover; }
  .trip-info { padding: 12px; }
  .trip-info h4 { margin: 0; color: #003a78; }
  .trip-info p { font-size: 0.9rem; color: #333; margin: 5px 0 10px; }
  .book-btn { background: #007acc; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; }
  .book-btn:hover { background: #005fa3; }
  .popup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; width: 320px; padding: 25px; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.3); z-index: 2000; }
  .popup.active { display: block; }
  .popup h3 { margin-top: 0; color: #003a78; border-bottom: 2px solid #007acc; padding-bottom: 5px; }
  .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1500; backdrop-filter: blur(2px); }
  .overlay.active { display: block; }
  .selection-container { max-width: 600px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); overflow: hidden;}
  .trip-banner { width: 100%; height: 220px; border-radius: 12px 12px 0 0; object-fit: cover; }
  .trip-title { text-align: center; background: #007acc; color: white; padding: 12px; font-size: 1.4rem; font-weight: 600; }
  .accordion { background-color: #007acc; color: #fff; cursor: pointer; padding: 14px 20px; width: 100%; text-align: left; border: none; outline: none; transition: 0.3s; font-weight: 500; border-radius: 8px; margin-top: 10px; display: flex; align-items: center; justify-content: space-between;}
  .accordion:hover { background-color: #005f99; }
  .accordion:after { content: '\25BC'; transition: transform 0.3s; }
  .accordion.active:after { transform: rotate(180deg); }
  .panel { background: #f1f8ff; border-radius: 0 0 8px 8px; overflow: hidden; padding: 0 20px; max-height: 0; transition: max-height 0.3s ease-out; }
  .panel.show { max-height: 2000px; transition: max-height 0.5s ease-in; }
  .panel ul { list-style: none; margin: 10px 0; padding: 0; }
  .panel li { padding: 8px 0; border-bottom: 1px solid #ddd; cursor: pointer; user-select: none; }
  .panel li:hover { background-color: #e6f2ff; }
  .panel > ul > li.selected { background-color: #007acc; color: white !important; font-weight: 600; }
  .sublist { margin-left: 20px; padding: 10px; border-radius: 8px; background-color: #e0f2ff; max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
  .sublist.show { max-height: 1500px; transition: max-height 0.5s ease-in; }
  .sub-section { display: none; background: #fff; border-radius: 10px; margin: 10px 0; padding: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);}
  .sub-section img { width: 100%; border-radius: 8px; margin-bottom: 8px;}
  .sub-section h4 { margin: 10px 0 5px; color: #007acc;}
  .summary-box { background: #fff; border-top: 2px solid #007acc; padding: 15px; margin-top: 10px; min-height: 48px;}
  .summary-box h4 { margin: 0 0 8px 0; color: #007acc;}
  #selectedItems { font-size: 0.95rem; color: #333; min-height: 24px; white-space: pre-wrap;}
  .summary-category { font-weight: bold; margin-top: 8px;}
  .summary-item { margin-left: 10px; cursor: pointer; }
  .summary-item:hover { text-decoration: underline; }
  .total { text-align: right; font-weight: 600; color: #333; padding: 8px 15px; border-top: 1px solid #ddd;}
  .button-group { display: flex; justify-content: space-between; margin: 10px 15px; }
  .btn-preview { flex: 1; padding: 12px; font-weight: bold; border-radius: 8px; color: white; text-align: center; cursor: pointer; user-select: none; text-decoration: none; background: #007acc; margin-right: 10px;}
  .btn-preview:hover { background: #005f99; }
  .panel > ul > li.toggle-sublist { font-weight: 700; color: #007acc; cursor: pointer;}
  
  /* Inputs for pax counts */
  .pax-inputs {
    margin: 10px 0 15px 0;
    display: flex;
    justify-content: space-between;
    gap: 15px;
    font-weight: 600;
    flex-wrap: wrap;
  }
  .pax-inputs label {
    display: flex;
    flex-direction: column;
    font-size: 0.9rem;
    color: #003a78;
    flex: 1;
    min-width: 120px;
  }
  .pax-inputs input[type=number] {
    margin-top: 4px;
    padding: 10px 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    width: 100%;
    font-size: 1rem;
    box-sizing: border-box;
    -webkit-appearance: none;
    -moz-appearance: textfield;
    background-color: white;
    touch-action: manipulation;
  }
  .pax-inputs input[type=number]:focus {
    outline-color: #007acc;
    border-color: #007acc;
    box-shadow: 0 0 5px rgba(0, 122, 204, 0.3);
  }
  .pax-inputs .input-group {
    display: flex;
    align-items: center;
    margin-top: 4px;
  }
  .pax-inputs .btn-decrement,
  .pax-inputs .btn-increment {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: #007acc;
    color: white;
    border: none;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: manipulation;
  }
  .pax-inputs .btn-decrement:hover,
  .pax-inputs .btn-increment:hover {
    background-color: #005fa3;
  }
  .pax-inputs .number-input {
    flex: 1;
    text-align: center;
    border-left: none;
    border-right: none;
  }
  .pax-inputs .btn-decrement {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }
  .pax-inputs .btn-increment {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
  .pax-count-display {
    font-weight: 600;
    color: #007acc;
    text-align: center;
    margin-top: 5px;
    font-size: 0.9rem;
  }
  .slider-arrow {
    color: #808080;
    font-size: 1em;
    cursor: pointer;
    background: white;
    padding: 6px 12px;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
  }
  .slider-arrow.left { left: -18px; }
  .slider-arrow.right { right: -18px; }
  
  /* Transportation styling */
  .transport-option { color: #0066cc; }
  .transport-option .item-name { color: #0066cc; }
  .transport-option.selected { color: white; }
  .transport-option.selected .item-name { color: white; }
  .transfer-option {
    padding: 8px 12px;
    margin: 5px 0;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .transfer-option:hover { background-color: #cce7ff; }
  .transfer-option.selected { background-color: #007acc; color: white; }
  .transfer-selection-hint { font-size: 0.85rem; color: #666; font-style: italic; margin-top: 5px; }
  .transfer-price { margin-left: 20px; font-weight: 600; }
  
  /* Horizontal sightseeing slider styling */
  .sightseeing-slider-container {
    position: relative;
    margin: 15px 0;
    overflow: hidden;
    border-radius: 8px;
  }
  .sightseeing-slider {
    display: flex;
    transition: transform 0.3s ease;
    gap: 15px;
  }
  .sightseeing-card {
    min-width: 160px;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: transform 0.2s;
  }
  .sightseeing-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
  .sightseeing-card img {
    width: 160px;
    height: 120px;
    object-fit: cover;
    cursor: zoom-in;
    transition: filter 0.3s;
  }
  .sightseeing-card img:hover {
    filter: brightness(1.1);
  }
  .sightseeing-card .place-name {
    padding: 8px;
    text-align: center;
    font-weight: 600;
    color: #003a78;
    font-size: 0.9rem;
  }
  .sightseeing-slider-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(255, 255, 255, 0.8);
    color: #333;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    z-index: 10;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .sightseeing-slider-arrow:hover { background-color: rgba(255, 255, 255, 0.95); }
  .sightseeing-slider-arrow.left { left: 10px; }
  .sightseeing-slider-arrow.right { right: 10px; }
  .sightseeing-transport {
    margin-top: 15px;
    border-top: 1px solid #ddd;
    padding-top: 10px;
  }
  .sightseeing-transport h5 { margin: 0 0 10px 0; color: #007acc; font-size: 1rem; }
  .transport-options { display: flex; flex-wrap: wrap; gap: 10px; }
  .transport-option-btn {
    padding: 8px 12px;
    border: 1px solid #007acc;
    border-radius: 6px;
    background: white;
    color: #007acc;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.9rem;
  }
  .transport-option-btn:hover { background-color: #e6f2ff; }
  .transport-option-btn.selected { background-color: #007acc; color: white; }
  
  /* Bike & Cab Selection Styling */
  .bike-selection, .cab-selection {
    margin-top: 10px;
    padding: 10px;
    background-color: #f0f7ff;
    border-radius: 6px;
    display: none;
  }
  .bike-selection.show, .cab-selection.show { display: block; }
  .bike-selection-label, .cab-selection-label { font-size: 0.9rem; color: #003a78; margin-bottom: 5px; font-weight: 600; }
  .bike-input-group, .cab-input-group { display: flex; align-items: center; gap: 10px; }
  .bike-input, .cab-input { width: 60px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; text-align: center; }
  .bike-price-display, .cab-price-display { font-size: 0.85rem; color: #666; margin-left: 10px; }
  
  /* Food options styling */
  .food-option { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #ddd; }
  .food-option-name { flex: 1; }
  .food-option-price { font-weight: 600; color: #007acc; }
  .food-option.selected { background-color: #e6f2ff; }
  
  /* Hotel Image Slider Styling */
  #hotelImg {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 8px;
    display: block;
    margin-bottom: 8px;
    background-color: #f0f0f0;
  }

  /* Hotel Detail Slider & Map Button */
  .hotel-details-slider {
      text-align: center;
  }
  
  /* Revised Map Button Style */
  .map-btn {
    margin-top: 12px;
    background-color: transparent;
    color: #007acc;
    border: none;
    padding: 5px 0;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    display: inline-block;
    align-items: center;
    gap: 8px;
    box-shadow: none;
    transition: color 0.3s;
    text-decoration: underline;
    text-align: left;
    margin-left: 0;
  }
  
  .map-btn:hover {
    color: #005f99;
    text-decoration: underline;
  }

  /* Container for location slide to align content left */
  .location-slide-content {
      text-align: left;
      width: 100%;
  }

  /* Mobile-specific styles */
  @media (max-width: 768px) {
    .main { padding: 80px 15px; }
    .site-title { font-size: 1.3rem; }
    .logo { width: 40px; height: 40px; }
    .pax-inputs { flex-direction: column; gap: 10px; }
    .pax-inputs label { min-width: 100%; }
    .transport-options { flex-direction: column; }
    .sightseeing-card { min-width: 140px; }
    .sightseeing-card img { width: 140px; height: 105px; }
    #hotelImg { height: 200px; }
    .popup-image-content { max-width: 95%; max-height: 70%; }
    .popup-caption { font-size: 1.1rem; bottom: 10%; }
  }
</style>
</head>
<body>

<!-- Animated Background Icons -->
<div class="icons">
    <i class="fas fa-umbrella-beach"></i>
    <i class="fas fa-water"></i>
    <i class="fas fa-sun"></i>
    <i class="fas fa-tree"></i>
    <i class="fas fa-ship"></i>
    <i class="fas fa-plane"></i>
    <i class="fas fa-cocktail"></i>
    <i class="fas fa-mountain"></i>
    <i class="fas fa-umbrella"></i>
    <i class="fas fa-passport"></i>
    <i class="fas fa-camera"></i>
    <i class="fas fa-hotel"></i>
    <i class="fas fa-map"></i>
    <i class="fas fa-bus"></i>
    <i class="fas fa-van-shuttle"></i>
</div>

<!-- Image Popup Modal Structure -->
<div id="imagePopupModal" class="image-popup-modal" onclick="closeImagePopup(event)">
  <span class="popup-close" onclick="closeImagePopup(event)">&times;</span>
  <div style="position:relative; display:flex; flex-direction:column; align-items:center;">
    <img class="popup-image-content" id="popupImageSrc" src="">
    <div class="popup-caption" id="popupImageCaption"></div>
  </div>
</div>

<header class="tt-header">
  <div class="logo-section">
    <button class="hamburger" onclick="toggleSidebar()">‚ò∞</button>
    <img src="logo.png" alt="TT World Logo" class="logo" />
    <h1 class="site-title">TT WORLD</h1>
  </div>
</header>
<div class="sidebar" id="sidebar">
  <a href="#" onclick="showHome()">üè† Home</a>
  <a href="#" onclick="showTrips()">‚úàÔ∏è Trips</a>
  <a href="#" onclick="openContact()">üìû Contact</a>
</div>
<div class="overlay" id="overlay" onclick="closeContact()"></div>
<div class="popup" id="contactPopup">
  <h3>Contact Information</h3>
  <p><b>Main Office:</b><br>13/1, Arni Road, Vellore, 632001</p>
  <p>üìû +91 95665 96825<br>üìû +91 72000 87875</p>
  <p><b>Email:</b> info@triptotheworld.in</p>
  <p><b>üåê Website:</b> <a href="https://www.triptotheworld.in" target="_blank" rel="noopener noreferrer">www.triptotheworld.in</a></p>
  <button onclick="closeContact()">Close</button>
</div>
<div class="main" id="mainContent">
  <h2>Welcome to TT World üåç</h2>
  <p>Select a section from sidebar to get started.</p>
</div>
<script>
// --- GLOBAL VARIABLES & STATE ---
let selectedItems = [];
let totalAmount = 0;
let daysSelected = 3;
let nightsSelected = 2;
let adultCount = 1;
let childCount = 0;
let currentHotelType = "casaMaria";
let currentHotelImageSlide = 0;
let currentHotelDetailSlide = 0;
let selectedPickup = "";
let selectedDrop = "";
let selectedSightseeingTransport = {};
let currentSightseeingSlides = {};
let bikeCounts = {};
let cabCounts = {};

// --- PRICING & DATA CONSTANTS ---
const PRICES = {
  hotelPerNight: { casaMaria: 1600, mayfieldBoutique: 1900, rivasaResort: 2200 },
  transportation: { pickup: 750, drop: 750 },
  sightseeingTransport: { ownTransfer: 0, privateBike: 500, cabWithDriver: 2000, cabWithoutDriver: 1800 },
  sightseeingPackage: { northGoa: 0, southGoa: 0, grandIslandFullDay: 1800, grandIslandHalfDay: 1200, malvanFullDay: 1800, malvanHalfDay: 1200, dudhsagarWaterfalls: 2000, dudhsagarFullDay: 2000 },
  food: { breakfast: 300, lunch: 700, dinner: 700 },
  cruisePackage: { dinnerCruise: 1200, casinoBigDaddyy: 4000 },
  otherActivities: { dinnerCruise: 1200, dudhsagarFullDay: 2000, casinoBigDaddyy: 4000 }
};

// Sightseeing places data
const sightseeingPlaces = {
  northGoa: [
    { name: "Fort Aguada", image: "Fort Aguada.jpeg" },
    { name: "Saligao Church", image: "saligao church.jpeg" },
    { name: "Sinquirim Beach", image: "Sinquirim Beach.jpeg" },
    { name: "Baga Beach", image: "Bagabeach.jpeg" },
    { name: "Old Goa Church", image: "oldgoachruch.jpeg" },
    { name: "Anjuna Beach", image: "Anjuna Beach.jpeg" },
    { name: "Vagator Beach", image: "Vagator Beach.jpeg" }
  ],
  southGoa: [
    { name: "Miramar Beach", image: "Miramar Beach.jpeg" },
    { name: "Basilica of born Jesus", image: "Basilica.jpeg" },
    { name: "Se Cathedral Church", image: "Se Cathedral Church.jpeg" },
    { name: "Shantadurga Temple", image: "oldgoachruch.jpeg" },
    { name: "Dolphin Sightseeing", image: "Dolphin Sightseeing.jpeg" },
    { name: "Mangeshi Temple", image: "Mangeshi Temple.jpeg" },
    { name: "Boat Cruise De goa", image: "cruise.jpg" }
  ],
  grandIslandFullDay: [
    { name: "Jet Ski", image: "Jet Ski.jpeg" },
    { name: "Banana Boat", image: "Banana Boat.jpeg" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Bumper Ride", image: "Bumper Ride.webp" },
    { name: "Snorkeling", image: "Snorkeling.png" },
    { name: "Parasailing", image: "parasailing.jpeg" },
    { name: "Speed Boat Ride", image: "speed.jpg" }
  ],
  grandIslandHalfDay: [
    { name: "Jet Ski", image: "Jet Ski.jpeg" },
    { name: "Banana Boat", image: "Banana Boat.jpeg" },
    { name: "Bumper Ride", image: "Bumper Ride.webp" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Snorkeling", image: "Snorkeling.png" },
    { name: "Parasailing", image: "para.jpg" },
    { name: "Speed Boat Ride", image: "speed.jpg" }
  ],
  malvanFullDay: [
    { name: "Parasailing", image: "para.jpg" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Tarkarli Beach", image: "tarkarli.png" },
    { name: "Rock Garden", image: "Rock garden.png" },
    { name: "Water Sports", image: "devbag.jpeg" }
  ],
  malvanHalfDay: [
    { name: "Scuba Diving", image: "Scuba.png" },
    { name: "Parasailing", image: "para.jpg" },
    { name: "Tarkarli Beach", image: "tarkarli.png" },
    { name: "Rock Garden", image: "Rock garden.png" },
    { name: "Devbag", image: "devbag.jpeg" }
  ],
  dudhsagarWaterfalls: [
    { name: "Dudhsagar Waterfalls", image: "Dudhsagar Waterfalls.jpeg" }
  ]
};

const hotelImages = {
  casaMaria: ["https://r1imghtlak.mmtcdn.com/1493b06f-8b80-43af-ac8d-29ab83522822.jpeg","https://r1imghtlak.mmtcdn.com/4964c816-69de-49eb-b32b-bd2ff954578e.jpeg","https://r1imghtlak.mmtcdn.com/e9c06472-51e0-414a-860d-32ba48984d1d.jpg","https://r1imghtlak.mmtcdn.com/552631e3-28a6-42df-8f61-f5fe4eb7e504.jpeg","https://r1imghtlak.mmtcdn.com/1bb89522-71a1-42c2-b099-c10f27753618.jpg",
             "https://r1imghtlak.mmtcdn.com/901e32c7-2656-4ba0-9f11-139c685366bc.jpeg","https://r1imghtlak.mmtcdn.com/81c1c79f-e8dc-48b5-8f38-db58ee5058e5.jpg","https://r1imghtlak.mmtcdn.com/5997eb7f-86af-4172-9d37-a4f905f44efe.jpg","https://r1imghtlak.mmtcdn.com/ea100c9d-529f-4393-8416-ab9c00726aa2.jpg",
             "https://r1imghtlak.mmtcdn.com/4f8f0db7-4399-488f-81ea-15b36e87544b.jpg","https://r1imghtlak.mmtcdn.com/0e781951-1138-4314-9046-eaf977781fc1.jpg"],
  mayfieldBoutique: ["https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-181d433c-7fbe-4515-b442-3d2eb24a898c.jpg","https://r1imghtlak.mmtcdn.com/e0a753db-e46f-43a3-a6bb-54af4bd5de1a.png","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-c233f8f1-4a84-4bca-bba0-aa8749cf220a.jpg","https://r1imghtlak.mmtcdn.com/3e53b1e89f6f11eb96e60242ac110004.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-13846-d432c4469f7011eb9e0c0242ac110002.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-40899-7cae5e489f6f11eba2670242ac110002.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-beb31df8-8167-422b-9e1d-578d1c40e4d8.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-c2398438-067c-4933-b2d9-cbb8004591bb.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-1eedcff2-ce4d-46dd-a6aa-91025774b732.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-1ae70006-c5f7-4292-81b4-18739604bc25.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-8085766-09135b1c-9d4d-4fca-8bd1-f8a84bcca8d4.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-8085768-01513075-51a2-47fe-a1cb-62177c8c48b2.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-1eedcff2-ce4d-46dd-a6aa-91025774b732.jpg","https://r1imghtlak.mmtcdn.com/7de61a69-4a68-46af-a362-848fbf0e7b7e.jpg"],
  rivasaResort: ["https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/200710170911208196-208261-28701d28-a418-40cb-aa14-d55884e92b26.jpg","https://r1imghtlak.mmtcdn.com/a4030424-e52b-489c-8d8d-ccc89a1f2377.jpeg","https://r1imghtlak.mmtcdn.com/bfc1855d-619b-4ff2-8c98-14f05f15c39f.jpg","https://r1imghtlak.mmtcdn.com/9304bb0eef1911e99bd00242ac110002.jpg","https://r1imghtlak.mmtcdn.com/b72dca6c59c211e98bf40242ac110002.jpg",
                "https://r1imghtlak.mmtcdn.com/c83c9520a01711eba0200242ac110002.jpg","https://r1imghtlak.mmtcdn.com/8af42401-5d90-44c0-b4b4-4259b5e43a03.jpg","https://r1imghtlak.mmtcdn.com/641781fb-eec6-4ed9-a42a-4c53b85133ca.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/200710170911208196-54de1d88-e842-42b7-b6dd-a2a148404e17.jpg",
                "https://r1imghtlak.mmtcdn.com/458bc260ca3811e99bb90242ac110003.jpg","https://r1imghtlak.mmtcdn.com/b57f3e14ef1611e9b20a0242ac110002.jpg","https://r1imghtlak.mmtcdn.com/bed284ca9ffb11eb943d0242ac110004.jpg","https://r1imghtlak.mmtcdn.com/de96ce66ef1611e9b6db0242ac110005.jpg","https://r1imghtlak.mmtcdn.com/5b5637b6-cd13-4e45-a2c3-035484a7fba5.jpg","https://r1imghtlak.mmtcdn.com/6e1b6d22-8226-4ee0-a99c-0976c233d969.jpg"]
};

const hotelDetailsMap = {
  casaMaria: { 
    img: hotelImages.casaMaria[0], 
    title: "Casa Maria", 
    desc: "Room Amenities", 
    location: "Holiday St, Gauravaddo, Calangute, Goa 403516",
    mapLink: "https://www.google.com/maps/search/?api=1&query=Casa+Maria+Holiday+St+Gauravaddo+Calangute+Goa"
  },
  mayfieldBoutique: { 
    img: hotelImages.mayfieldBoutique[0], 
    title: "Mayfield Boutique", 
    desc: "Boutique rooms feature additional space, modern furnishings, premium linen, a work desk, and a balcony with garden or pool view.", 
    location: "Naikawaddo, near Calangute - Anjuna Rd, near Dharwadkar Hospital, Dongorpur, Calangute, Goa 403516",
    mapLink: "https://www.google.com/maps/search/?api=1&query=The+Mayfield+Boutique+Hotel+Calangute+Goa"
  },
  rivasaResort: { 
    img: hotelImages.rivasaResort[0], 
    title: "Rivasa Resort", 
    desc: "Rivasa Resort ‚Äì Calangute, Goa",
    location: "Rivasa Resort - 5 mins walk to Calangute Beach, Dr Afonso Rd, Calangute, Goa 403516",
    mapLink: "https://www.google.com/maps/search/?api=1&query=Rivasa+Resort+Calangute+Goa"
  }
};

// --- CORE UTILITY FUNCTIONS ---
function formatPrice(val) { return `‚Çπ${val.toLocaleString('en-IN')}`; }
function toggleSidebar() { document.getElementById("sidebar").classList.toggle("active"); }
function showHome() { document.getElementById("mainContent").innerHTML = "<h2>Welcome to TT World üåç</h2><p>Discover amazing trips!</p>"; document.getElementById("sidebar").classList.remove("active"); }
function openContact() { document.getElementById("contactPopup").classList.add("active"); document.getElementById("overlay").classList.add("active"); document.getElementById("sidebar").classList.remove("active"); }
function closeContact() { document.getElementById("contactPopup").classList.remove("active"); document.getElementById("overlay").classList.remove("active"); }

// --- IMAGE POPUP LOGIC ---
function openImagePopup(src, name) {
  const modal = document.getElementById("imagePopupModal");
  const img = document.getElementById("popupImageSrc");
  const caption = document.getElementById("popupImageCaption");
  img.src = src;
  caption.innerText = name;
  modal.classList.add("active");
}

function closeImagePopup(e) {
  if (e.target.id === "imagePopupModal" || e.target.classList.contains('popup-close')) {
    const modal = document.getElementById("imagePopupModal");
    modal.classList.remove("active");
  }
}

// --- TRIP LOADING & DYNAMIC CONTENT ---
function showTrips() {
  document.getElementById("mainContent").innerHTML = `
    <h2>Explore Our Tour Packages ‚úàÔ∏è</h2>
    <div class='trip-section'>
      <div class='trip-card'>
        <img src='goabeach.png' alt='Goa Beach'/>
        <div class='trip-info'>
          <h4>Goa Beach Getaway</h4>
          <p>Enjoy sunny beaches, nightlife, and heritage.</p>
          <button class='book-btn' onclick='loadGoaSelection()'>View Details</button>
        </div>
      </div>
    </div>
  `;
  document.getElementById("sidebar").classList.remove("active");
}

function loadGoaSelection() {
  document.getElementById("mainContent").innerHTML = `
    <div class="selection-container" id="selectionContainer">
      <img src="goabeach.png" alt="Goa Beach" class="trip-banner" />
      <div class="trip-title">Goa Trip</div>
      <button class="accordion">Days / Nights</button>
      <div class="panel"><ul id="daysList"><li data-days="3" data-nights="2">2 Nights / 3 Days</li><li data-days="4" data-nights="3">3 Nights / 4 Days</li><li data-days="5" data-nights="4">4 Nights / 5 Days</li></ul></div>
      <button class="accordion">Passengers</button>
      <div class="panel">
        <div class="pax-inputs" id="paxInputs">
          <label for="adultCount">
            Adults:
            <div class="input-group">
              <button class="btn-decrement" onclick="decrementAdult()">-</button>
              <input type="number" id="adultCount" min="1" max="10" value="1" class="number-input" />
              <button class="btn-increment" onclick="incrementAdult()">+</button>
            </div>
            <div class="pax-count-display" id="adultDisplay">1 Adult</div>
          </label>
          <label for="childCount">
            Children:
            <div class="input-group">
              <button class="btn-decrement" onclick="decrementChild()">-</button>
              <input type="number" id="childCount" min="0" max="10" value="0" class="number-input" />
              <button class="btn-increment" onclick="incrementChild()">+</button>
            </div>
            <div class="pax-count-display" id="childDisplay">0 Children</div>
          </label>
        </div>
      </div>
      <button class="accordion">Pickup and Drop</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Transportation" data-key="pickup">
            <span class="item-name">Pickup</span>
            <span class="transfer-price" id="pickupPriceDisplay"></span>
            <div class="transfer-selection-hint">Click to select pickup option</div>
          </li>
          <ul class="sublist">
            <li class="transfer-option" data-transfer="airport" data-type="pickup" data-price="750">Airport Pickup (‚Çπ750 per person)</li>
            <li class="transfer-option" data-transfer="railway" data-type="pickup" data-price="750">Railway Station Pickup (‚Çπ750 per person)</li>
          </ul>
          <li class="toggle-sublist" data-category="Transportation" data-key="drop">
            <span class="item-name">Drop</span>
            <span class="transfer-price" id="dropPriceDisplay"></span>
            <div class="transfer-selection-hint">Click to select drop option</div>
          </li>
          <ul class="sublist">
            <li class="transfer-option" data-transfer="airport" data-type="drop" data-price="750">Airport Drop (‚Çπ750 per person)</li>
            <li class="transfer-option" data-transfer="railway" data-type="drop" data-price="750">Railway Station Drop (‚Çπ750 per person)</li>
          </ul>
        </ul>
      </div>
      <button class="accordion">Hotel</button>
      <div class="panel">
        <ul>
          <li class="hotel-option" data-price="1600" data-type="casaMaria" data-category="Hotel"><span class="item-name">Casa Maria</span><span class="item-price" style="margin-left: 20px;">‚Çπ1600 per person</span></li>
          <li class="hotel-option" data-price="1900" data-type="mayfieldBoutique" data-category="Hotel"><span class="item-name">Mayfield Boutique</span><span class="item-price" style="margin-left: 20px;">‚Çπ1900 per person</span></li>
          <li class="hotel-option" data-price="2200" data-type="rivasaResort" data-category="Hotel"><span class="item-name">Rivasa Resort</span><span class="item-price" style="margin-left: 20px;">‚Çπ2200 per person</span></li>
        </ul>
        <div id="hotelDetails" class="sub-section" style="text-align:center; margin-top:10px; display:none;"></div>
      </div>
      <button class="accordion">Sightseeing</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="northGoa"><span class="item-name">North Goa Tour</span><span class="item-price" style="margin-left:20px;">Free</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="southGoa"><span class="item-name">South Goa Tour</span><span class="item-price" style="margin-left:20px;">Free</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="grandIslandFullDay"><span class="item-name">Grand Island Full Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1800</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="grandIslandHalfDay"><span class="item-name">Grand Island Half Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="malvanFullDay"><span class="item-name">Malvan Full Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1800</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="malvanHalfDay"><span class="item-name">Malvan Half Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <ul class="sublist"></ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="dudhsagarWaterfalls"><span class="item-name">Dudhsagar Waterfalls</span><span class="item-price" style="margin-left:20px;">‚Çπ2000</span></li>
          <ul class="sublist"></ul>
        </ul>
      </div>
      <button class="accordion">Otheractivities</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Other Activities" data-package="dinnerCruise"><span class="item-name">Dinner Cruise</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <li class="toggle-sublist" data-category="Other Activities" data-package="dudhsagarFullDay"><span class="item-name">Doodhsagar Full Day Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ2000</span></li>
          <li class="toggle-sublist" data-category="Other Activities" data-package="casinoBigDaddyy"><span class="item-name">Casino at Big Daddyy</span><span class="item-price" style="margin-left:20px;">‚Çπ4000</span></li>
        </ul>
      </div>
      <button class="accordion">Food</button>
      <div class="panel">
        <div class="food-option" data-type="breakfast" data-category="Food" data-price="300">
          <span class="food-option-name">Breakfast</span>
          <span class="food-option-price">‚Çπ300 per person</span>
        </div>
        <div class="food-option" data-type="lunch" data-category="Food" data-price="700">
          <span class="food-option-name">Lunch</span>
          <span class="food-option-price">‚Çπ700 per person</span>
        </div>
        <div class="food-option" data-type="dinner" data-category="Food" data-price="700">
          <span class="food-option-name">Dinner</span>
          <span class="food-option-price">‚Çπ700 per person</span>
        </div>
      </div>
      <div class="summary-box"><h4>Selected Items:</h4><div id="selectedItems">None</div></div>
      <div class="total" id="totalAmount">Grand Total: ‚Çπ0</div>
      <div class="button-group"><a href="#" id="previewBtn" class="btn-preview">üîç Preview</a></div>
    </div>
  `;
  initializeEventListeners();
  setTimeout(() => { updateDynamicPrices(); }, 100);
}

// --- PASSENGER COUNT FUNCTIONS ---
function incrementAdult() { const input = document.getElementById("adultCount"); const value = parseInt(input.value) || 0; if (value < 10) { input.value = value + 1; onPaxChanged(); } }
function decrementAdult() { const input = document.getElementById("adultCount"); const value = parseInt(input.value) || 0; if (value > 1) { input.value = value - 1; onPaxChanged(); } }
function incrementChild() { const input = document.getElementById("childCount"); const value = parseInt(input.value) || 0; if (value < 10) { input.value = value + 1; onPaxChanged(); } }
function decrementChild() { const input = document.getElementById("childCount"); const value = parseInt(input.value) || 0; if (value > 0) { input.value = value - 1; onPaxChanged(); } }

// --- EVENT HANDLING & LOGIC ---
function initializeEventListeners() {
  const acc = document.getElementsByClassName("accordion");
  for (let i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      for (let j = 0; j < acc.length; j++) { if (j !== i) { acc[j].classList.remove("active"); acc[j].nextElementSibling.classList.remove("show"); } }
      this.classList.toggle("active"); this.nextElementSibling.classList.toggle("show");
    });
  }

  document.querySelectorAll(".panel li.toggle-sublist").forEach(title => {
    title.addEventListener("click", (e) => {
      e.stopPropagation();
      const key = title.getAttribute('data-key');
      if (key === 'pickup' || key === 'drop') {
        const isAlreadySelected = title.classList.contains("selected");
        if (isAlreadySelected) { unselectTransfer(key); } else { const siblingList = title.nextElementSibling; if (siblingList && siblingList.classList.contains('sublist')) { siblingList.classList.toggle("show"); } }
      } else {
        const siblingList = title.nextElementSibling;
        if (siblingList && siblingList.classList.contains('sublist')) {
          siblingList.classList.toggle("show");
          const packageKey = title.getAttribute('data-package');
          if (packageKey && title.getAttribute('data-category') === 'Sightseeing') { addSightseeingContent(title, packageKey); }
        }
      }
    });
  });

  document.querySelectorAll(".transfer-option").forEach(option => { option.addEventListener("click", (e) => { e.stopPropagation(); selectTransfer(option); }); });
  document.querySelectorAll("#daysList li").forEach(dayLi => { dayLi.addEventListener("click", () => onDaysSelected(dayLi)); });

  const adultInput = document.getElementById("adultCount");
  const childInput = document.getElementById("childCount");
  if (adultInput) { adultInput.addEventListener("input", onPaxChanged); adultInput.addEventListener("change", onPaxChanged); adultInput.addEventListener("blur", onPaxChanged); adultInput.addEventListener("touchend", onPaxChanged); }
  if (childInput) { childInput.addEventListener("input", onPaxChanged); childInput.addEventListener("change", onPaxChanged); childInput.addEventListener("blur", onPaxChanged); childInput.addEventListener("touchend", onPaxChanged); }

  document.querySelectorAll(".panel li, .food-option").forEach(item => { if (item.closest("#daysList")) return; item.addEventListener("click", e => { e.stopPropagation(); handleItemClick(item); }); });

  const previewBtn = document.getElementById("previewBtn");
  if (previewBtn) { previewBtn.addEventListener("click", (e) => { e.preventDefault(); generatePreview(); }); }
}

// Add sightseeing content with horizontal slider and transport options
function addSightseeingContent(titleElement, packageKey) {
  const sublist = titleElement.nextElementSibling;
  if (sublist.querySelector('.sightseeing-slider-container')) return;
  if (!currentSightseeingSlides[packageKey]) { currentSightseeingSlides[packageKey] = 0; }
  
  const sliderContainer = document.createElement('div');
  sliderContainer.className = 'sightseeing-slider-container';
  sliderContainer.innerHTML = `
    <div class="sightseeing-slider" id="sightseeing-slider-${packageKey}">
      ${sightseeingPlaces[packageKey].map(place => `
        <div class="sightseeing-card">
          <img src="${place.image}" alt="${place.name}" onclick="openImagePopup('${place.image}', '${place.name}')">
          <div class="place-name">${place.name}</div>
        </div>
      `).join('')}
    </div>
    <button class="sightseeing-slider-arrow left" onclick="changeSightseeingSlide('${packageKey}', -1)">&lt;</button>
    <button class="sightseeing-slider-arrow right" onclick="changeSightseeingSlide('${packageKey}', 1)">&gt;</button>
  `;
  
  const transportSection = document.createElement('div');
  transportSection.className = 'sightseeing-transport';
  transportSection.innerHTML = `
    <h5>Transportation Options</h5>
    <div class="transport-options">
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="ownTransfer">Own Transfer</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="privateBike">Private Bike</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="cabWithDriver">Cab with Driver</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="cabWithoutDriver">Cab without Driver</button>
    </div>
    <div class="bike-selection" id="bike-selection-${packageKey}">
      <div class="bike-selection-label">Number of Bikes (‚Çπ500 per bike):</div>
      <div class="bike-input-group">
        <button class="btn-decrement" onclick="decrementBike('${packageKey}')">-</button>
        <input type="number" id="bike-count-${packageKey}" class="bike-input" min="1" max="10" value="1">
        <button class="btn-increment" onclick="incrementBike('${packageKey}')">+</button>
        <span class="bike-price-display" id="bike-price-${packageKey}">‚Çπ500</span>
      </div>
    </div>
    <div class="cab-selection" id="cab-selection-${packageKey}">
      <div class="cab-selection-label">Number of Cabs (‚Çπ2000 per cab with driver / ‚Çπ1800 per cab without driver):</div>
      <div class="cab-input-group">
        <button class="btn-decrement" onclick="decrementCab('${packageKey}')">-</button>
        <input type="number" id="cab-count-${packageKey}" class="cab-input" min="1" max="10" value="1">
        <button class="btn-increment" onclick="incrementCab('${packageKey}')">+</button>
        <span class="cab-price-display" id="cab-price-${packageKey}">‚Çπ2000</span>
      </div>
    </div>
  `;
  
  sublist.appendChild(sliderContainer);
  sublist.appendChild(transportSection);
  updateSightseeingSliderPosition(packageKey);
  
  transportSection.querySelectorAll('.transport-option-btn').forEach(btn => { btn.addEventListener('click', (e) => { e.stopPropagation(); selectSightseeingTransport(btn); }); });
  const bikeInput = transportSection.querySelector(`#bike-count-${packageKey}`);
  if (bikeInput) { bikeInput.addEventListener('input', () => updateBikeCount(packageKey)); bikeInput.addEventListener('change', () => updateBikeCount(packageKey)); }
  const cabInput = transportSection.querySelector(`#cab-count-${packageKey}`);
  if (cabInput) { cabInput.addEventListener('input', () => updateCabCount(packageKey)); cabInput.addEventListener('change', () => updateCabCount(packageKey)); }
  
  if (selectedSightseeingTransport[packageKey]) {
    const selectedBtn = transportSection.querySelector(`[data-transport="${selectedSightseeingTransport[packageKey]}"]`);
    if (selectedBtn) {
      selectedBtn.classList.add('selected');
      if (selectedSightseeingTransport[packageKey] === 'privateBike') {
        const bikeSelection = transportSection.querySelector(`#bike-selection-${packageKey}`);
        if (bikeSelection) { bikeSelection.classList.add('show'); const savedCount = bikeCounts[packageKey] || 1; bikeInput.value = savedCount; updateBikePrice(packageKey); }
      } else if (selectedSightseeingTransport[packageKey] === 'cabWithDriver' || selectedSightseeingTransport[packageKey] === 'cabWithoutDriver') {
        const cabSelection = transportSection.querySelector(`#cab-selection-${packageKey}`);
        if (cabSelection) { cabSelection.classList.add('show'); const savedCount = cabCounts[packageKey] || 1; cabInput.value = savedCount; updateCabPrice(packageKey); }
      }
    }
  }
}

// Bike, Cab, Transport Logic
function incrementBike(pk) { const i = document.getElementById(`bike-count-${pk}`); const v = parseInt(i.value) || 0; if (v < 10) { i.value = v + 1; updateBikeCount(pk); } }
function decrementBike(pk) { const i = document.getElementById(`bike-count-${pk}`); const v = parseInt(i.value) || 0; if (v > 1) { i.value = v - 1; updateBikeCount(pk); } }
function updateBikeCount(pk) { const i = document.getElementById(`bike-count-${pk}`); if (i) { const c = Math.max(1, parseInt(i.value) || 1); i.value = c; bikeCounts[pk] = c; updateBikePrice(pk); updateSightseeingTransportInSelection(pk, 'privateBike'); updateNorthSouthGoaDisplay(pk); } }
function updateBikePrice(pk) { const c = bikeCounts[pk] || 1; const d = document.getElementById(`bike-price-${pk}`); if (d) { d.textContent = formatPrice(PRICES.sightseeingTransport.privateBike * c); } }

function incrementCab(pk) { const i = document.getElementById(`cab-count-${pk}`); const v = parseInt(i.value) || 0; if (v < 10) { i.value = v + 1; updateCabCount(pk); } }
function decrementCab(pk) { const i = document.getElementById(`cab-count-${pk}`); const v = parseInt(i.value) || 0; if (v > 1) { i.value = v - 1; updateCabCount(pk); } }
function updateCabCount(pk) { const i = document.getElementById(`cab-count-${pk}`); if (i) { const c = Math.max(1, parseInt(i.value) || 1); i.value = c; cabCounts[pk] = c; updateCabPrice(pk); updateSightseeingTransportInSelection(pk, selectedSightseeingTransport[pk]); updateNorthSouthGoaDisplay(pk); } }
function updateCabPrice(pk) { const c = cabCounts[pk] || 1; const t = selectedSightseeingTransport[pk]; const p = t === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; const d = document.getElementById(`cab-price-${pk}`); if (d) { d.textContent = formatPrice(p * c); } }

function updateNorthSouthGoaDisplay(pk) {
  if (pk !== 'northGoa' && pk !== 'southGoa') return;
  const el = document.querySelector(`[data-package="${pk}"]`); if (!el) return;
  const ps = el.querySelector('.item-price'); if (!ps) return;
  if (selectedSightseeingTransport[pk] === 'privateBike') { const c = bikeCounts[pk] || 1; const p = PRICES.sightseeingTransport.privateBike * c; ps.textContent = `${c} Bike${c > 1 ? 's' : ''} (${formatPrice(p)})`; }
  else if (selectedSightseeingTransport[pk] === 'cabWithDriver' || selectedSightseeingTransport[pk] === 'cabWithoutDriver') {
    const c = cabCounts[pk] || 1; const t = selectedSightseeingTransport[pk];
    const p = t === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
    ps.textContent = `${c} ${t === 'cabWithDriver' ? 'Cab with Driver' : 'Cab without Driver'} (${formatPrice(p * c)})`;
  } else { ps.textContent = "Free"; }
}

function changeSightseeingSlide(pk, dir) {
  const pl = sightseeingPlaces[pk]; if (!pl || pl.length === 0) return;
  const sl = document.getElementById(`sightseeing-slider-${pk}`); if (!sl) return;
  const cw = 175; const vc = Math.floor(sl.parentElement.offsetWidth / cw);
  const ms = Math.max(0, pl.length - vc);
  currentSightseeingSlides[pk] += dir;
  if (currentSightseeingSlides[pk] < 0) { currentSightseeingSlides[pk] = 0; } else if (currentSightseeingSlides[pk] > ms) { currentSightseeingSlides[pk] = ms; }
  updateSightseeingSliderPosition(pk);
}
function updateSightseeingSliderPosition(pk) { const sl = document.getElementById(`sightseeing-slider-${pk}`); if (!sl) return; sl.style.transform = `translateX(-${currentSightseeingSlides[pk] * 175}px)`; }

function selectSightseeingTransport(btn) {
  const pk = btn.getAttribute('data-package'); const tt = btn.getAttribute('data-transport');
  btn.parentElement.querySelectorAll('.transport-option-btn').forEach(b => { b.classList.remove('selected'); });
  btn.classList.add('selected');
  const bs = document.getElementById(`bike-selection-${pk}`); const cs = document.getElementById(`cab-selection-${pk}`);
  if (bs) bs.classList.remove('show'); if (cs) cs.classList.remove('show');
  if (tt === 'privateBike') { if (bs) { bs.classList.add('show'); if (!bikeCounts[pk]) { bikeCounts[pk] = 1; const bi = document.getElementById(`bike-count-${pk}`); if (bi) bi.value = 1; updateBikePrice(pk); } } }
  else if (tt === 'cabWithDriver' || tt === 'cabWithoutDriver') { if (cs) { cs.classList.add('show'); if (!cabCounts[pk]) { cabCounts[pk] = 1; const ci = document.getElementById(`cab-count-${pk}`); if (ci) ci.value = 1; updateCabPrice(pk); } } }
  selectedSightseeingTransport[pk] = tt;
  updateNorthSouthGoaDisplay(pk);
  updateSightseeingTransportInSelection(pk, tt);
}

function updateSightseeingTransportInSelection(pk, tt) {
  const si = selectedItems.find(item => item.category === 'Sightseeing' && item.type === pk);
  if (si) {
    si.transport = tt; let tp = 0;
    if (tt === 'privateBike') { const c = bikeCounts[pk] || 1; tp = PRICES.sightseeingTransport[tt] * c; }
    else if (tt === 'cabWithDriver' || tt === 'cabWithoutDriver') { const c = cabCounts[pk] || 1; const p = tt === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; tp = p * c; }
    else { tp = PRICES.sightseeingTransport[tt]; }
    const bp = PRICES.sightseeingPackage[pk]; const tppl = adultCount + (childCount * 0.5);
    si.price = (bp + tp) * tppl; si.transportPrice = tp * tppl;
    si.bikeCount = tt === 'privateBike' ? (bikeCounts[pk] || 1) : 0;
    si.cabCount = (tt === 'cabWithDriver' || tt === 'cabWithoutDriver') ? (cabCounts[pk] || 1) : 0;
  }
  updateSummary();
}

function unselectTransfer(key) {
  document.querySelectorAll(`.transfer-option[data-type="${key}"]`).forEach(opt => { opt.classList.remove("selected"); });
  if (key === 'pickup') selectedPickup = ""; else if (key === 'drop') selectedDrop = "";
  selectedItems = selectedItems.filter(item => item.key !== key);
  const tl = document.querySelector(`[data-key="${key}"]`); if (tl) { tl.classList.remove("selected"); document.getElementById(`${key}PriceDisplay`).textContent = ""; const h = tl.querySelector(".transfer-selection-hint"); if (h) h.style.display = "block"; }
  updateSummary();
}

function selectTransfer(opt) {
  const type = opt.getAttribute("data-type"); const tf = opt.getAttribute("data-transfer"); const bp = parseInt(opt.getAttribute("data-price"));
  document.querySelectorAll(`.transfer-option[data-type="${type}"]`).forEach(o => { o.classList.remove("selected"); });
  opt.classList.add("selected");
  if (type === 'pickup') selectedPickup = tf; else if (type === 'drop') selectedDrop = tf;
  selectedItems = selectedItems.filter(item => item.key !== type);
  const price = bp * adultCount;
  selectedItems.push({ name: `${type.charAt(0).toUpperCase() + type.slice(1)} (${tf.charAt(0).toUpperCase() + tf.slice(1)})`, price: price, category: "Transportation", key: type, type: tf });
  const pl = opt.closest(".sublist").previousElementSibling; if (pl) { pl.classList.add("selected"); document.getElementById(`${type}PriceDisplay`).textContent = formatPrice(price); const h = pl.querySelector(".transfer-selection-hint"); if (h) h.style.display = "none"; }
  updateSummary();
}

function onDaysSelected(li) {
  daysSelected = parseInt(li.dataset.days); nightsSelected = parseInt(li.dataset.nights);
  document.querySelectorAll("#daysList li").forEach(d => d.classList.remove("selected")); li.classList.add("selected");
  clearSelectionsExceptDaysAndPax(); updateDynamicPrices(); updateSummary();
}

function onPaxChanged() {
  const aI = document.getElementById("adultCount"); const cI = document.getElementById("childCount");
  adultCount = Math.max(1, parseInt(aI.value) || 1); childCount = Math.max(0, parseInt(cI.value) || 0); aI.value = adultCount; cI.value = childCount;
  const aD = document.getElementById("adultDisplay"); const cD = document.getElementById("childDisplay");
  if (aD) aD.textContent = `${adultCount} Adult${adultCount > 1 ? 's' : ''}`; if (cD) cD.textContent = `${childCount} Child${childCount !== 1 ? 'ren' : ''}`;
  updateDynamicPrices();
  const hi = selectedItems.find(item => item.category === "Hotel"); if (hi) { const p = PRICES.hotelPerNight[hi.type]; const tp = adultCount + childCount; hi.price = p * tp; hi.perPersonPrice = p; }
  if (selectedPickup) { const to = document.querySelector(`.transfer-option[data-type="pickup"][data-transfer="${selectedPickup}"]`); if (to) selectTransfer(to); }
  if (selectedDrop) { const to = document.querySelector(`.transfer-option[data-type="drop"][data-transfer="${selectedDrop}"]`); if (to) selectTransfer(to); }
  selectedItems.forEach(item => { if (item.category === "Food") { const p = PRICES.food[item.type]; item.price = p * adultCount + Math.floor(p * 0.5) * childCount; item.perPersonPrice = p; } });
  selectedItems.forEach(item => {
    if (item.category === "Sightseeing") {
      const bp = PRICES.sightseeingPackage[item.type]; let tp = 0;
      if (item.transport === 'privateBike') { const c = bikeCounts[item.type] || 1; tp = PRICES.sightseeingTransport[item.transport] * c; }
      else if (item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') { const c = cabCounts[item.type] || 1; const p = item.transport === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; tp = p * c; }
      else { tp = item.transport ? PRICES.sightseeingTransport[item.transport] : 0; }
      const tppl = adultCount + (childCount * 0.5); item.price = (bp + tp) * tppl; item.transportPrice = tp * tppl;
    }
  });
  updateSummary();
}

function handleItemClick(item) {
  const ns = item.querySelector('.item-name'); const iname = ns ? ns.textContent.trim() : item.textContent.trim();
  const ip = Number(item.getAttribute("data-price")) || 0; const cat = item.getAttribute("data-category") || "Others";
  const isH = item.classList.contains("hotel-option"); const isF = item.classList.contains("food-option");
  const isS = item.classList.contains("toggle-sublist") && item.getAttribute("data-category") === "Sightseeing";
  const isO = item.classList.contains("toggle-sublist") && item.getAttribute("data-category") === "Other Activities";
  const type = item.getAttribute("data-type") || item.getAttribute("data-package");

  if (item.classList.contains("selected")) {
    item.classList.remove("selected"); selectedItems = selectedItems.filter(i => i.name !== iname);
    if (isH) document.getElementById("hotelDetails").style.display = "none";
  } else {
    if (isH) { document.querySelectorAll('.hotel-option.selected').forEach(e => e.classList.remove('selected')); selectedItems = selectedItems.filter(i => i.category !== "Hotel"); const p = PRICES.hotelPerNight[type]; const tp = adultCount + childCount; selectedItems.push({ name: iname, price: p * tp, category: cat, type: type, perPersonPrice: p }); }
    if (isF) {
      item.classList.add("selected"); selectedItems = selectedItems.filter(i => i.category !== "Food" || i.type !== type); const p = PRICES.food[type]; const tpp = p * adultCount + Math.floor(p * 0.5) * childCount;
      selectedItems.push({ name: iname, price: tpp, category: cat, type: type, perPersonPrice: p });
    } else if (!isH && !isF) {
      item.classList.add("selected"); selectedItems = selectedItems.filter(i => i.name !== iname);
      if (isS) { const bp = PRICES.sightseeingPackage[type]; const tppl = adultCount + (childCount * 0.5); selectedItems.push({ name: iname, price: bp * tppl, category: cat, type: type, transport: 'ownTransfer', transportPrice: 0, bikeCount: 0, cabCount: 0 }); selectedSightseeingTransport[type] = 'ownTransfer'; }
      else { selectedItems.push({ name: iname, price: ip, category: cat, type: type }); }
    }
  }
  if (isH) { item.classList.add("selected"); showHotelDetails(type); }
  updateSummary();
}

// --- DYNAMIC UI UPDATES ---
function updateDynamicPrices() {
  document.querySelectorAll(".hotel-option").forEach(el => { const t = el.getAttribute("data-type"); if (t && PRICES.hotelPerNight[t]) { const p = PRICES.hotelPerNight[t]; const tp = adultCount + childCount; el.setAttribute("data-price", p * tp); const ps = el.querySelector(".item-price"); if (ps) ps.textContent = formatPrice(p) + " per person"; } });
  document.querySelectorAll('[data-category="Sightseeing"]').forEach(el => {
    const pk = el.getAttribute('data-package'); if (pk && PRICES.sightseeingPackage[pk] !== undefined) {
      const bp = PRICES.sightseeingPackage[pk]; let tp = 0;
      if (selectedSightseeingTransport[pk] === 'privateBike') { const c = bikeCounts[pk] || 1; tp = PRICES.sightseeingTransport.privateBike * c; }
      else if (selectedSightseeingTransport[pk] === 'cabWithDriver' || selectedSightseeingTransport[pk] === 'cabWithoutDriver') { const c = cabCounts[pk] || 1; const p = selectedSightseeingTransport[pk] === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; tp = p * c; }
      else if (selectedSightseeingTransport[pk]) { tp = PRICES.sightseeingTransport[selectedSightseeingTransport[pk]]; }
      const tppl = adultCount + (childCount * 0.5); const price = (bp + tp) * tppl; el.setAttribute("data-price", Math.round(price));
      const ps = el.querySelector(".item-price"); if (ps) { if (pk === 'northGoa' || pk === 'southGoa') { if (selectedSightseeingTransport[pk] === 'privateBike') { const c = bikeCounts[pk] || 1; const p = PRICES.sightseeingTransport.privateBike * c; ps.textContent = `${c} Bike${c > 1 ? 's' : ''} (${formatPrice(p)})`; } else if (selectedSightseeingTransport[pk] === 'cabWithDriver' || selectedSightseeingTransport[pk] === 'cabWithoutDriver') { const c = cabCounts[pk] || 1; const t = selectedSightseeingTransport[pk]; const p = t === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; ps.textContent = `${c} ${t === 'cabWithDriver' ? 'Cab with Driver' : 'Cab without Driver'} (${formatPrice(p * c)})`; } else { ps.textContent = "Free"; } } else { ps.textContent = formatPrice(Math.round(price)); } } else { ps.textContent = formatPrice(Math.round(price)); } }
  });
  document.querySelectorAll('[data-category="Other Activities"]').forEach(el => { const pk = el.getAttribute('data-package'); if (pk && PRICES.otherActivities[pk]) { const price = PRICES.otherActivities[pk] * (adultCount + (childCount * 0.5)); el.setAttribute("data-price", Math.round(price)); const ps = el.querySelector(".item-price"); if (ps) ps.textContent = formatPrice(Math.round(price)); } });
}

function updateSummary() {
  if (selectedItems.length === 0) { document.getElementById("selectedItems").innerHTML = "None"; document.getElementById("totalAmount").textContent = "Grand Total: ‚Çπ0"; totalAmount = 0; return; }
  const categories = {}; totalAmount = 0; selectedItems.forEach(item => { if (!categories[item.category]) categories[item.category] = []; categories[item.category].push(item); });
  let html = `<div class="summary-category">Trip Duration</div><div class="summary-item">${daysSelected} Days / ${nightsSelected} Nights</div>`;
  html += `<div class="summary-category">Passengers</div><div class="summary-item">${adultCount} Adult${adultCount > 1 ? 's' : ''}${childCount > 0 ? ', ' + childCount + ' Child' + (childCount > 1 ? 'ren' : '') : ''}</div>`;
  for (const cat in categories) {
    html += `<div class="summary-category">${cat}</div>`;
    categories[cat].forEach(item => {
      let line = `${item.name}`; const tppl = adultCount + (childCount * 0.5);
      if (item.price > 0) {
        if (cat === "Hotel" && item.perPersonPrice) { line += ` (${formatPrice(item.perPersonPrice)} √ó ${adultCount + childCount} people = ${formatPrice(item.price)})`; }
        else if (cat === "Food" && item.perPersonPrice) { const cp = Math.floor(item.perPersonPrice * 0.5); line += ` (${formatPrice(item.perPersonPrice)} √ó ${adultCount} adults`; if (childCount > 0) line += ` + ${formatPrice(cp)} √ó ${childCount} children`; line += ` = ${formatPrice(item.price)})`; }
        else if (cat === "Sightseeing") { const bp = PRICES.sightseeingPackage[item.type]; if (bp === 0) { line += ` (Free tour`; if (item.transport && item.transport !== 'ownTransfer') { if (item.transport === 'privateBike' && item.bikeCount > 0) line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`; else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) { const p = item.transport === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; line += ` + ${formatPrice(p)} √ó ${item.cabCount} ${item.transport}`; } else line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${tppl} people for ${item.transport}`; } line += ` = ${formatPrice(item.price)})`; } else { line += ` (${formatPrice(bp)} √ó ${tppl} people`; if (item.transport && item.transport !== 'ownTransfer') { if (item.transport === 'privateBike' && item.bikeCount > 0) line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`; else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) { const p = item.transport === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; line += ` + ${formatPrice(p)} √ó ${item.cabCount} ${item.transport}`; } else line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${tppl} people for ${item.transport}`; } line += ` = ${formatPrice(item.price)})`; } }
        else if (cat === "Transportation" && (item.key === 'pickup' || item.key === 'drop')) { line += ` (${formatPrice(PRICES.transportation[item.key])} √ó ${adultCount} adults = ${formatPrice(item.price)})`; }
        else { line += ` (${formatPrice(item.price)})`; }
      } else { if (cat === "Sightseeing" && PRICES.sightseeingPackage[item.type] === 0) { line += ` (Free tour`; if (item.transport && item.transport !== 'ownTransfer') { if (item.transport === 'privateBike' && item.bikeCount > 0) line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`; else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) { const p = item.transport === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver; line += ` + ${formatPrice(p)} √ó ${item.cabCount} ${item.transport}`; } else line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${tppl} people for ${item.transport}`; } line += ` = ${formatPrice(item.price)})`; } else { line += ` (Free)`; } }
      html += `<div class="summary-item" data-category="${item.category}" data-type="${item.type}">${line}</div>`; totalAmount += item.price;
    });
  }
  document.getElementById("selectedItems").innerHTML = html; document.getElementById("totalAmount").textContent = `Grand Total: ${formatPrice(totalAmount)}`;
  document.querySelectorAll('.summary-item').forEach(item => { item.addEventListener('click', () => { const c = item.dataset.category; const t = item.dataset.type; if (c === 'Hotel') showHotelDetails(t); if (c === 'Transportation' || c === 'Sightseeing' || c === 'Cruise' || c === 'Other Activities') { const acc = [...document.querySelectorAll('.accordion')].find(a => a.textContent.toLowerCase().includes(c.toLowerCase())); if (acc) { acc.click(); acc.scrollIntoView({ behavior: 'smooth', block: 'center' }); } } }); });
}

function clearSelectionsExceptDaysAndPax() {
  document.querySelectorAll('.panel li.selected').forEach(el => { if (!el.closest("#daysList")) el.classList.remove('selected'); }); document.querySelectorAll('.food-option.selected').forEach(el => el.classList.remove('selected'));
  selectedItems = []; selectedPickup = ""; selectedDrop = ""; selectedSightseeingTransport = {}; bikeCounts = {}; cabCounts = {};
  document.querySelectorAll('[data-key="pickup"], [data-key="drop"]').forEach(li => { li.classList.remove("selected"); const key = li.getAttribute('data-key'); document.getElementById(`${key}PriceDisplay`).textContent = ""; const hint = li.querySelector(".transfer-selection-hint"); if (hint) hint.style.display = "block"; });
  ['northGoa', 'southGoa'].forEach(pk => { const el = document.querySelector(`[data-package="${pk}"]`); if (el) { const ps = el.querySelector('.item-price'); if (ps) ps.textContent = "Free"; } });
}

// --- DETAIL DISPLAY FUNCTIONS ---
function showHotelDetails(hotelType) {
  const detailsDiv = document.getElementById("hotelDetails"); if (!hotelDetailsMap[hotelType]) return;
  currentHotelType = hotelType; currentHotelImageSlide = 0; currentHotelDetailSlide = 0;
  detailsDiv.style.display = "block";
  detailsDiv.innerHTML = `
    <div class="hotel-image-slider" style="position:relative;">
      <span class="slider-arrow left" onclick="prevHotelImageSlide()">&lt;</span>
      <img id="hotelImg" src="${hotelImages[hotelType][0]}">
      <span class="slider-arrow right" onclick="nextHotelImageSlide()">&gt;</span>
    </div>
    <div class="hotel-details-slider" style="position:relative;margin-top:4px;">
      <span class="slider-arrow left" onclick="prevHotelDetailSlide()">&lt;</span>
      <div id="hotelDetailSlideContent"></div>
      <span class="slider-arrow right" onclick="nextHotelDetailSlide()">&gt;</span>
    </div>
  `;
  renderHotelDetailSlide();
}

function renderHotelDetailSlide() { 
  const d = hotelDetailsMap[currentHotelType]; 
  let h = "";
  if (currentHotelDetailSlide === 0) {
     h = `<h4 style="color:#003a78;">${d.title} Details</h4><p>${d.desc}</p>`;
  } else {
     h = `<div class="location-slide-content">
            <h4 style="color:#003a78; margin-top:0;">Location</h4>
            <p>${d.location}</p>
            ${d.mapLink ? `<button class="map-btn" onclick="window.open('${d.mapLink}', '_blank')">View Map</button>` : ''}
          </div>`;
  }
  document.getElementById("hotelDetailSlideContent").innerHTML = h; 
}

function prevHotelImageSlide() { const images = hotelImages[currentHotelType] || []; if (images.length === 0) return; currentHotelImageSlide = (currentHotelImageSlide - 1 + images.length) % images.length; document.getElementById("hotelImg").src = images[currentHotelImageSlide]; }
function nextHotelImageSlide() { const images = hotelImages[currentHotelType] || []; if (images.length === 0) return; currentHotelImageSlide = (currentHotelImageSlide + 1) % images.length; document.getElementById("hotelImg").src = images[currentHotelImageSlide]; }
function prevHotelDetailSlide() { currentHotelDetailSlide = (currentHotelDetailSlide === 0) ? 1 : 0; renderHotelDetailSlide(); }
function nextHotelDetailSlide() { currentHotelDetailSlide = (currentHotelDetailSlide === 1) ? 0 : 1; renderHotelDetailSlide(); }

// --- PREVIEW GENERATION ---
function generatePreview() {
  const summaryHTML = document.getElementById("selectedItems").innerHTML; const totalText = document.getElementById("totalAmount").innerText;
  const previewWindow = window.open('', '', 'width=900,height=1200'); let tableRows = '';
  if (summaryHTML.trim() === "" || summaryHTML.trim() === "None") { tableRows = "<p>No items selected.</p>"; } else {
    const tempDiv = document.createElement('div'); tempDiv.innerHTML = summaryHTML; let rows = []; let currentCat = '';
    tempDiv.childNodes.forEach(node => { if (node.classList && node.classList.contains('summary-category')) { currentCat = node.innerText; } else if (node.classList && node.classList.contains('summary-item')) { let nameText = node.innerText; let [name, price] = nameText.split(' (‚Çπ'); price = price ? "‚Çπ" + price.replace(")", "") : "-"; rows.push({category: currentCat, name: name, price: price}); } });
    if(rows.length > 0) { tableRows = '<table id="previewTable"><thead><tr><th>Category</th><th>Item</th><th>Price</th></tr></thead><tbody>'; rows.forEach(row => { tableRows += `<tr><td>${row.category || ''}</td><td>${row.name || ''}</td><td>${row.price || '-'}</td></tr>`; }); tableRows += '</tbody></table>'; }
  }
  previewWindow.document.write(`<!DOCTYPE html><html><head><title>TT World - Trip Costs</title><style>body{font-family:"Poppins",sans-serif;margin:0;padding:20px 40px;background:#fff;color:#222;line-height:1.4}.top-header{background:#181e39;color:#fff;padding:35px 0 20px 0;position:relative;text-align:center;margin-bottom:30px;border-radius:8px}.top-header .brand{font-size:2.4rem;font-weight:bold;color:#ffe128;letter-spacing:2px;display:block}.top-header .subtitle{color:#ffe128;font-size:1.1rem;margin-top:6px;margin-bottom:30px;letter-spacing:1px;font-style:italic}.top-header .section-icons{margin-bottom:15px}.top-header .section-icons span{background:#ffe128;color:#222;border-radius:6px;margin:0 10px;padding:6px 16px;font-size:1rem;font-weight:500;display:inline-block}.top-header .contacts{font-size:1rem;margin:10px 0 0;color:#fff}.top-header .contacts span{margin:0 20px}.top-header .address{margin-top:7px;font-size:0.92rem;color:#cfcfcf}.yellow-bar{width:100%;background:#ffe128;padding:18px 0;text-align:center;margin:0 0 20px 0;border-radius:8px}.yellow-bar span{font-size:2rem;font-weight:bold;color:#222;letter-spacing:2px}.selected-list{max-width:700px;margin:0 auto;border:2px solid #007acc;border-radius:10px;padding:20px;background:#f9faff}.selected-list h3{margin-bottom:15px;font-size:1.5rem;color:#007acc;text-align:center}.selected-list table{width:100%;border-collapse:collapse;font-size:1.1rem}.selected-list th,.selected-list td{padding:10px 12px;border-bottom:1px solid #ddd;text-align:left}.selected-list th{background:#e0e9f8;color:#222;font-weight:600;border-bottom:3px solid #007acc}.total-row{font-weight:bold;color:#111;font-size:1.3rem;text-align:right;border-top:3px solid #007acc;padding-top:15px}.footer{margin-top:60px;text-align:center;color:#111;font-size:1rem;font-weight:600}</style></head><body><div class="top-header"><span class="brand">TT World</span><div class="subtitle">Trip to the world</div><div class="section-icons"><span>Tour Packages</span><span>Flight Booking</span><span>Train Booking</span><span>Visa Services</span></div><div class="contacts"><span>www.triptotheworld.in</span> | <span>+91 72000 87875</span> | <span>soundarraj@triptotheworld.in</span></div><div class="address">13/1, Arni Road, Kosapet, Vellore</div></div></div><div class="yellow-bar"><span>TRIP COSTS</span></div><div class="selected-list"><h3>Selected Items</h3>${tableRows}<div class="total-row">${totalText}</div></div><div class="footer">Travel far to find yourself ‚Äî TT World</div></body></html>`);
  previewWindow.document.close();
}

window.onload = function() { showTrips(); };
</script>
</body>
</html>
