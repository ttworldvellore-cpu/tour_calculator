<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TT World - Goa Trip</title>
<style>
  body {
    margin: 0;
    font-family: "Poppins", sans-serif;
    background: #f6f8fa;
    padding: 0;
  }
  /* HEADER */
  header.tt-header {
    background-color: #007acc;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 25px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1100;
  }
  .logo-section { display: flex; align-items: center; gap: 15px; }
  .logo { width: 50px; height: 50px; object-fit: contain; border-radius: 10px; background: white; padding: 5px; }
  .site-title { font-size: 1.6rem; margin: 0; font-weight: 600; letter-spacing: 1px; }
  .hamburger { font-size: 26px; cursor: pointer; padding: 8px 12px; background: #005fa3; color: white; border: none; border-radius: 6px; }
  .sidebar { position: fixed; left: -250px; top: 70px; height: calc(100% - 70px); width: 250px; background: #003a78; color: white; transition: all 0.3s ease; padding-top: 10px; box-shadow: 3px 0 10px rgba(0,0,0,0.2); z-index: 1000; }
  .sidebar.active { left: 0; }
  .sidebar a { display: block; padding: 15px 25px; color: white; text-decoration: none; font-size: 16px; }
  .sidebar a:hover { background: #0056a3; }
  .main { padding: 100px 25px; transition: margin-left 0.3s; }
  .sidebar.active ~ .main { margin-left: 250px; }
  .trip-section { display: flex; justify-content: center; margin-top: 40px; }
  .trip-card { background: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; width: 260px; transition: transform 0.3s; }
  .trip-card:hover { transform: translateY(-5px); }
  .trip-card img { width: 100%; height: 150px; object-fit: cover; }
  .trip-info { padding: 12px; }
  .trip-info h4 { margin: 0; color: #003a78; }
  .trip-info p { font-size: 0.9rem; color: #333; margin: 5px 0 10px; }
  .book-btn { background: #007acc; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; }
  .book-btn:hover { background: #005fa3; }
  .popup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; width: 320px; padding: 25px; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.3); z-index: 2000; }
  .popup.active { display: block; }
  .popup h3 { margin-top: 0; color: #003a78; border-bottom: 2px solid #007acc; padding-bottom: 5px; }
  .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1500; }
  .overlay.active { display: block; }
  .selection-container { max-width: 600px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); overflow: hidden;}
  .trip-banner { width: 100%; height: 220px; border-radius: 12px 12px 0 0; object-fit: cover; }
  .trip-title { text-align: center; background: #007acc; color: white; padding: 12px; font-size: 1.4rem; font-weight: 600; }
  .accordion { background-color: #007acc; color: #fff; cursor: pointer; padding: 14px 20px; width: 100%; text-align: left; border: none; outline: none; transition: 0.3s; font-weight: 500; border-radius: 8px; margin-top: 10px; display: flex; align-items: center; justify-content: space-between;}
  .accordion:hover { background-color: #005f99; }
  .accordion:after { content: '\25BC'; transition: transform 0.3s; }
  .accordion.active:after { transform: rotate(180deg); }
  .panel { background: #f1f8ff; border-radius: 0 0 8px 8px; overflow: hidden; padding: 0 20px; max-height: 0; transition: max-height 0.3s ease-out; }
  .panel.show { max-height: 2000px; transition: max-height 0.5s ease-in; }
  .panel ul { list-style: none; margin: 10px 0; padding: 0; }
  .panel li { padding: 8px 0; border-bottom: 1px solid #ddd; cursor: pointer; user-select: none; }
  .panel li:hover { background-color: #e6f2ff; }
  .panel > ul > li.selected { background-color: #007acc; color: white !important; font-weight: 600; }
  .sublist { margin-left: 20px; padding: 10px; border-radius: 8px; background-color: #e0f2ff; max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
  .sublist.show { max-height: 1500px; transition: max-height 0.5s ease-in; }
  .sub-section { display: none; background: #fff; border-radius: 10px; margin: 10px 0; padding: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);}
  .sub-section img { width: 100%; border-radius: 8px; margin-bottom: 8px;}
  .sub-section h4 { margin: 10px 0 5px; color: #007acc;}
  .summary-box { background: #fff; border-top: 2px solid #007acc; padding: 15px; margin-top: 10px; min-height: 48px;}
  .summary-box h4 { margin: 0 0 8px 0; color: #007acc;}
  #selectedItems { font-size: 0.95rem; color: #333; min-height: 24px; white-space: pre-wrap;}
  .summary-category { font-weight: bold; margin-top: 8px;}
  .summary-item { margin-left: 10px; cursor: pointer; }
  .summary-item:hover { text-decoration: underline; }
  .total { text-align: right; font-weight: 600; color: #333; padding: 8px 15px; border-top: 1px solid #ddd;}
  .button-group { display: flex; justify-content: space-between; margin: 10px 15px; }
  .btn-preview { flex: 1; padding: 12px; font-weight: bold; border-radius: 8px; color: white; text-align: center; cursor: pointer; user-select: none; text-decoration: none; background: #007acc; margin-right: 10px;}
  .btn-preview:hover { background: #005f99; }
  .panel > ul > li.toggle-sublist { font-weight: 700; color: #007acc; cursor: pointer;}
  /* Inputs for pax counts - Improved for mobile */
  .pax-inputs {
    margin: 10px 0 15px 0;
    display: flex;
    justify-content: space-between;
    gap: 15px;
    font-weight: 600;
    flex-wrap: wrap;
  }
  .pax-inputs label {
    display: flex;
    flex-direction: column;
    font-size: 0.9rem;
    color: #003a78;
    flex: 1;
    min-width: 120px;
  }
  .pax-inputs input[type=number] {
    margin-top: 4px;
    padding: 10px 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    width: 100%;
    font-size: 1rem;
    box-sizing: border-box;
    -webkit-appearance: none;
    -moz-appearance: textfield;
    background-color: white;
    touch-action: manipulation;
  }
  .pax-inputs input[type=number]:focus {
    outline-color: #007acc;
    border-color: #007acc;
    box-shadow: 0 0 5px rgba(0, 122, 204, 0.3);
  }
  .pax-inputs .input-group {
    display: flex;
    align-items: center;
    margin-top: 4px;
  }
  .pax-inputs .btn-decrement,
  .pax-inputs .btn-increment {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: #007acc;
    color: white;
    border: none;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: manipulation;
  }
  .pax-inputs .btn-decrement:hover,
  .pax-inputs .btn-increment:hover {
    background-color: #005fa3;
  }
  .pax-inputs .number-input {
    flex: 1;
    text-align: center;
    border-left: none;
    border-right: none;
  }
  .pax-inputs .btn-decrement {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }
  .pax-inputs .btn-increment {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
  .pax-count-display {
    font-weight: 600;
    color: #007acc;
    text-align: center;
    margin-top: 5px;
    font-size: 0.9rem;
  }
  .slider-arrow {
    color: #808080;
    font-size: 1em;
    cursor: pointer;
    background: white;
    padding: 6px 12px;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
  }
  .slider-arrow.left { left: -18px; }
  .slider-arrow.right { right: -18px; }
  
  /* Transportation styling */
  .transport-option {
    color: #0066cc;
  }
  .transport-option .item-name {
    color: #0066cc;
  }
  .transport-option.selected {
    color: white;
  }
  .transport-option.selected .item-name {
    color: white;
  }
  .transfer-option {
    padding: 8px 12px;
    margin: 5px 0;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .transfer-option:hover {
    background-color: #cce7ff;
  }
  .transfer-option.selected {
    background-color: #007acc;
    color: white;
  }
  .transfer-selection-hint {
    font-size: 0.85rem;
    color: #666;
    font-style: italic;
    margin-top: 5px;
  }
  .transfer-price {
    margin-left: 20px;
    font-weight: 600;
  }
  
  /* Horizontal sightseeing slider styling */
  .sightseeing-slider-container {
    position: relative;
    margin: 15px 0;
    overflow: hidden;
    border-radius: 8px;
  }
  .sightseeing-slider {
    display: flex;
    transition: transform 0.3s ease;
    gap: 15px;
  }
  .sightseeing-card {
    min-width: 160px;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: transform 0.2s;
  }
  .sightseeing-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
  .sightseeing-card img {
    width: 160px;
    height: 120px;
    object-fit: cover;
  }
  .sightseeing-card .place-name {
    padding: 8px;
    text-align: center;
    font-weight: 600;
    color: #003a78;
    font-size: 0.9rem;
  }
  .sightseeing-slider-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(255, 255, 255, 0.8);
    color: #333;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    z-index: 10;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .sightseeing-slider-arrow:hover {
    background-color: rgba(255, 255, 255, 0.95);
  }
  .sightseeing-slider-arrow.left {
    left: 10px;
  }
  .sightseeing-slider-arrow.right {
    right: 10px;
  }
  .sightseeing-transport {
    margin-top: 15px;
    border-top: 1px solid #ddd;
    padding-top: 10px;
  }
  .sightseeing-transport h5 {
    margin: 0 0 10px 0;
    color: #007acc;
    font-size: 1rem;
  }
  .transport-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .transport-option-btn {
    padding: 8px 12px;
    border: 1px solid #007acc;
    border-radius: 6px;
    background: white;
    color: #007acc;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.9rem;
  }
  .transport-option-btn:hover {
    background-color: #e6f2ff;
  }
  .transport-option-btn.selected {
    background-color: #007acc;
    color: white;
  }
  
  /* Bike selection styling */
  .bike-selection {
    margin-top: 10px;
    padding: 10px;
    background-color: #f0f7ff;
    border-radius: 6px;
    display: none;
  }
  .bike-selection.show {
    display: block;
  }
  .bike-selection-label {
    font-size: 0.9rem;
    color: #003a78;
    margin-bottom: 5px;
    font-weight: 600;
  }
  .bike-input-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .bike-input {
    width: 60px;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    text-align: center;
  }
  .bike-price-display {
    font-size: 0.85rem;
    color: #666;
    margin-left: 10px;
  }
  
  /* Cab selection styling */
  .cab-selection {
    margin-top: 10px;
    padding: 10px;
    background-color: #f0f7ff;
    border-radius: 6px;
    display: none;
  }
  .cab-selection.show {
    display: block;
  }
  .cab-selection-label {
    font-size: 0.9rem;
    color: #003a78;
    margin-bottom: 5px;
    font-weight: 600;
  }
  .cab-input-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .cab-input {
    width: 60px;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    text-align: center;
  }
  .cab-price-display {
    font-size: 0.85rem;
    color: #666;
    margin-left: 10px;
  }
  
  /* Food options styling */
  .food-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #ddd;
  }
  .food-option-name {
    flex: 1;
  }
  .food-option-price {
    font-weight: 600;
    color: #007acc;
  }
  .food-option.selected {
    background-color: #e6f2ff;
  }
  
  /* Mobile-specific styles */
  @media (max-width: 768px) {
    .main {
      padding: 80px 15px;
    }
    .site-title {
      font-size: 1.3rem;
    }
    .logo {
      width: 40px;
      height: 40px;
    }
    .pax-inputs {
      flex-direction: column;
      gap: 10px;
    }
    .pax-inputs label {
      min-width: 100%;
    }
    .transport-options {
      flex-direction: column;
    }
    .sightseeing-card {
      min-width: 140px;
    }
    .sightseeing-card img {
      width: 140px;
      height: 105px;
    }
  }
</style>
</head>
<body>
<header class="tt-header">
  <div class="logo-section">
    <button class="hamburger" onclick="toggleSidebar()">‚ò∞</button>
    <img src="logo.png" alt="TT World Logo" class="logo" />
    <h1 class="site-title">TT WORLD</h1>
  </div>
</header>
<div class="sidebar" id="sidebar">
  <a href="#" onclick="showHome()">üè† Home</a>
  <a href="#" onclick="showTrips()">‚úàÔ∏è Trips</a>
  <a href="#" onclick="openContact()">üìû Contact</a>
</div>
<div class="overlay" id="overlay" onclick="closeContact()"></div>
<div class="popup" id="contactPopup">
  <h3>Contact Information</h3>
  <p><b>Main Office:</b><br>13/1, Arni Road, Vellore, 632001</p>
  <p>üìû +91 95665 96825<br>üìû +91 72000 87875</p>
  <p><b>Email:</b> info@triptotheworld.in</p>
  <p><b>üåê Website:</b> <a href="https://www.triptotheworld.in" target="_blank" rel="noopener noreferrer">www.triptotheworld.in</a></p>
  <button onclick="closeContact()">Close</button>
</div>
<div class="main" id="mainContent">
  <h2>Welcome to TT World üåç</h2>
  <p>Select a section from sidebar to get started.</p>
</div>
<script>
// --- GLOBAL VARIABLES & STATE ---
let selectedItems = [];
let totalAmount = 0;
let daysSelected = 3;
let nightsSelected = 2;
let adultCount = 1;
let childCount = 0;
let currentHotelType = "casaMaria";
let currentHotelImageSlide = 0;
let currentHotelDetailSlide = 0;
let selectedPickup = ""; // Track selected pickup
let selectedDrop = ""; // Track selected drop
let selectedSightseeingTransport = {}; // Track transport for each sightseeing
let currentSightseeingSlides = {}; // Track current slide for each sightseeing
let bikeCounts = {}; // Track bike counts for each transport selection
let cabCounts = {}; // Track cab counts for each transport selection

// --- PRICING & DATA CONSTANTS ---
const PRICES = {
  hotelPerNight: { 
    casaMaria: 1600, 
    mayfieldBoutique: 1900, 
    rivasaResort: 2200 
  },
  transportation: { 
    pickup: 750, // Price per person for pickup (3000 for 4 people)
    drop: 750 // Price per person for drop (3000 for 4 people)
  },
  sightseeingTransport: {
    ownTransfer: 0,
    privateBike: 500, // Changed to 500 per bike as requested
    cabWithDriver: 2000, // Updated to 2000 per cab as requested
    cabWithoutDriver: 1800 // Updated to 1800 per cab as requested
  },
  sightseeingPackage: { 
    northGoa: 0, // Changed from 500 to 0 as requested
    southGoa: 0, // Changed from 500 to 0 as requested
    grandIslandFullDay: 1800,
    grandIslandHalfDay: 1200,
    malvanFullDay: 1800,
    malvanHalfDay: 1200,
    dudhsagarWaterfalls: 2000,
    dudhsagarFullDay: 2000
  },
  food: {
    breakfast: 300,
    lunch: 700,
    dinner: 700
  },
  cruisePackage: { 
    dinnerCruise: 1200,
    casinoBigDaddyy: 4000
  },
  otherActivities: {
    dinnerCruise: 1200,
    dudhsagarFullDay: 2000,
    casinoBigDaddyy: 4000
  }
};

// Sightseeing places data with images
const sightseeingPlaces = {
  northGoa: [
    { name: "Fort Aguada", image: "Fort Aguada.jpeg" },
    { name: "Saligao Church", image: "saligao church.jpeg" },
    { name: "Sinquirim Beach", image: "Sinquirim Beach.jpeg" },
    { name: "Baga Beach", image: "Bagabeach.jpeg" },
    { name: "Old Goa Church", image: "oldgoachruch.jpeg" },
    { name: "Anjuna Beach", image: "Anjuna Beach.jpeg" },
    { name: "Vagator Beach", image: "Vagator Beach.jpeg" }
  ],
  southGoa: [
    { name: "Miramar Beach", image: "Miramar Beach.jpeg" },
    { name: "Basilica of born Jesus", image: "Basilica.jpeg" },
    { name: "Se Cathedral Church", image: "Se Cathedral Church.jpeg" },
    { name: "Shantadurga Temple", image: "oldgoachruch.jpeg" },
    { name: "Dolphin Sightseeing", image: "Dolphin Sightseeing.jpeg" },
    { name: "Mangeshi Temple", image: "Mangeshi Temple.jpeg" },
    { name: "Boat Cruise De goa", image: "cruise.jpg" }
  ],
  grandIslandFullDay: [
    { name: "Jet Ski", image: "Jet Ski.jpeg" },
    { name: "Banana Boat", image: "Banana Boat.jpeg" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Bumper Ride", image: "Bumper Ride.webp" },
    { name: "Snorkeling", image: "Snorkeling.png" },
    { name: "Parasailing", image: "parasailing.jpeg" },
    { name: "Speed Boat Ride", image: "speed.jpg" }
  ],
  grandIslandHalfDay: [
    { name: "Jet Ski", image: "Jet Ski.jpeg" },
    { name: "Banana Boat", image: "Banana Boat.jpeg" },
    { name: "Bumper Ride", image: "Bumper Ride.webp" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Snorkeling", image: "Snorkeling.png" },
    { name: "Parasailing", image: "para.jpg" },
    { name: "Speed Boat Ride", image: "speed.jpg" }
  ],
  malvanFullDay: [
    { name: "Parasailing", image: "para.jpg" },
    { name: "Scuba Diving", image: "Scuba Diving.jpeg" },
    { name: "Tarkarli Beach", image: "tarkarli.png" },
    { name: "Rock Garden", image: "Rock garden.png" },
    { name: "Water Sports", image: "devbag.jpeg" }
  ],
  malvanHalfDay: [
    { name: "Scuba Diving", image: "Scuba.png" },
    { name: "Parasailing", image: "para.jpg" },
    { name: "Tarkarli Beach", image: "tarkarli.png" },
    { name: "Rock Garden", image: "Rock garden.png" },
    { name: "Devbag", image: "devbag.jpeg" }
  ],
  dudhsagarWaterfalls: [
    { name: "Dudhsagar Waterfalls", image: "Dudhsagar Waterfalls.jpeg" }
  ]
};

const hotelImages = {
  casaMaria: ["https://r1imghtlak.mmtcdn.com/1493b06f-8b80-43af-ac8d-29ab83522822.jpeg","https://r1imghtlak.mmtcdn.com/4964c816-69de-49eb-b32b-bd2ff954578e.jpeg","https://r1imghtlak.mmtcdn.com/e9c06472-51e0-414a-860d-32ba48984d1d.jpg","https://r1imghtlak.mmtcdn.com/552631e3-28a6-42df-8f61-f5fe4eb7e504.jpeg","https://r1imghtlak.mmtcdn.com/1bb89522-71a1-42c2-b099-c10f27753618.jpg",
             "https://r1imghtlak.mmtcdn.com/901e32c7-2656-4ba0-9f11-139c685366bc.jpeg","https://r1imghtlak.mmtcdn.com/81c1c79f-e8dc-48b5-8f38-db58ee5058e5.jpg","https://r1imghtlak.mmtcdn.com/5997eb7f-86af-4172-9d37-a4f905f44efe.jpg","https://r1imghtlak.mmtcdn.com/ea100c9d-529f-4393-8416-ab9c00726aa2.jpg",
             "https://r1imghtlak.mmtcdn.com/4f8f0db7-4399-488f-81ea-15b36e87544b.jpg","https://r1imghtlak.mmtcdn.com/0e781951-1138-4314-9046-eaf977781fc1.jpg"],
  mayfieldBoutique: ["https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-181d433c-7fbe-4515-b442-3d2eb24a898c.jpg","https://r1imghtlak.mmtcdn.com/e0a753db-e46f-43a3-a6bb-54af4bd5de1a.png","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-c233f8f1-4a84-4bca-bba0-aa8749cf220a.jpg","https://r1imghtlak.mmtcdn.com/3e53b1e89f6f11eb96e60242ac110004.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-13846-d432c4469f7011eb9e0c0242ac110002.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-40899-7cae5e489f6f11eba2670242ac110002.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-beb31df8-8167-422b-9e1d-578d1c40e4d8.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-c2398438-067c-4933-b2d9-cbb8004591bb.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-1eedcff2-ce4d-46dd-a6aa-91025774b732.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-208261-1ae70006-c5f7-4292-81b4-18739604bc25.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-8085766-09135b1c-9d4d-4fca-8bd1-f8a84bcca8d4.jpg",
                    "https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/202103240931205880-8085768-01513075-51a2-47fe-a1cb-62177c8c48b2.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/202103240931205880-1eedcff2-ce4d-46dd-a6aa-91025774b732.jpg","https://r1imghtlak.mmtcdn.com/7de61a69-4a68-46af-a362-848fbf0e7b7e.jpg"],
  rivasaResort: ["https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/room-imgs/200710170911208196-208261-28701d28-a418-40cb-aa14-d55884e92b26.jpg","https://r1imghtlak.mmtcdn.com/a4030424-e52b-489c-8d8d-ccc89a1f2377.jpeg","https://r1imghtlak.mmtcdn.com/bfc1855d-619b-4ff2-8c98-14f05f15c39f.jpg","https://r1imghtlak.mmtcdn.com/9304bb0eef1911e99bd00242ac110002.jpg","https://r1imghtlak.mmtcdn.com/b72dca6c59c211e98bf40242ac110002.jpg",
                "https://r1imghtlak.mmtcdn.com/c83c9520a01711eba0200242ac110002.jpg","https://r1imghtlak.mmtcdn.com/8af42401-5d90-44c0-b4b4-4259b5e43a03.jpg","https://r1imghtlak.mmtcdn.com/641781fb-eec6-4ed9-a42a-4c53b85133ca.jpg","https://r2imghtlak.mmtcdn.com/r2-mmt-htl-image/htl-imgs/200710170911208196-54de1d88-e842-42b7-b6dd-a2a148404e17.jpg",
                "https://r1imghtlak.mmtcdn.com/458bc260ca3811e99bb90242ac110003.jpg","https://r1imghtlak.mmtcdn.com/b57f3e14ef1611e9b20a0242ac110002.jpg","https://r1imghtlak.mmtcdn.com/bed284ca9ffb11eb943d0242ac110004.jpg","https://r1imghtlak.mmtcdn.com/de96ce66ef1611e9b6db0242ac110005.jpg","https://r1imghtlak.mmtcdn.com/5b5637b6-cd13-4e45-a2c3-035484a7fba5.jpg","https://r1imghtlak.mmtcdn.com/6e1b6d22-8226-4ee0-a99c-0976c233d969.jpg"]
};

const hotelDetailsMap = {
  casaMaria: { 
    img: hotelImages.casaMaria[0], 
    title: "Casa Maria", 
    desc: "Room Amenities
At CASA MARIA, all rooms come with a balcony. Featuring a private bathroom equipped with a shower and free toiletries, each room provides guests with a garden view.

Additionally, every room is fitted with air conditioning and a flat-screen TV.

Dining Options
Guests can enjoy a continental or an American breakfast at CASA MARIA.

Nearby Attractions
Basilica Of Bom Jesus is located 22 km from the property, while Church of Saint Cajetan is 23 km away.

The nearest airport is Manohar Parrikar International Airport, situated 26 km from CASA MARIA.  CASA MARIA
Located in Calangute, 400 metres from Calangute Beach, CASA MARIA offers accommodation with a garden, free private parking, a restaurant and a bar.

The property is conveniently situated 400 metres from Candolim Beach, 11 km from Chapora Fort, and 19 km from Thivim railway station.

Tiracol Fort is 38 km away, and Margao Railway Station is 45 km from the property.", 
    location: "Central Panaji, near bus station" 
  },
  mayfieldBoutique: { 
    img: hotelImages.mayfieldBoutique[0], 
    title: "Mayfield Boutique", 
    desc: "Boutique rooms feature additional space, modern furnishings, premium linen, a work desk, and a balcony with garden or pool view.", 
    location: "Close to Baga Beach and local markets" 
  },
  rivasaResort: { 
    img: hotelImages.rivasaResort[0], 
    title: "Rivasa Resort", 
    desc: "The Rivasa Resort, a budget retreat set in the lap of nature minutes away from the Calangute Beach!", 
    location: "Exclusive stretch in South Goa" 
  }
};

// --- CORE UTILITY FUNCTIONS ---
function formatPrice(val) { return `‚Çπ${val.toLocaleString('en-IN')}`; }
function toggleSidebar() { document.getElementById("sidebar").classList.toggle("active"); }
function showHome() { document.getElementById("mainContent").innerHTML = "<h2>Welcome to TT World üåç</h2><p>Discover amazing trips!</p>"; document.getElementById("sidebar").classList.remove("active"); }
function openContact() { document.getElementById("contactPopup").classList.add("active"); document.getElementById("overlay").classList.add("active"); document.getElementById("sidebar").classList.remove("active"); }
function closeContact() { document.getElementById("contactPopup").classList.remove("active"); document.getElementById("overlay").classList.remove("active"); }

// --- TRIP LOADING & DYNAMIC CONTENT ---
function showTrips() {
  document.getElementById("mainContent").innerHTML = `
    <h2>Explore Our Tour Packages ‚úàÔ∏è</h2>
    <div class='trip-section'>
      <div class='trip-card'>
        <img src='goabeach.png' alt='Goa Beach'/>
        <div class='trip-info'>
          <h4>Goa Beach Getaway</h4>
          <p>Enjoy sunny beaches, nightlife, and heritage.</p>
          <button class='book-btn' onclick='loadGoaSelection()'>View Details</button>
        </div>
      </div>
    </div>
  `;
  document.getElementById("sidebar").classList.remove("active");
}

function loadGoaSelection() {
  document.getElementById("mainContent").innerHTML = `
    <div class="selection-container" id="selectionContainer">
      <img src="goabeach.png" alt="Goa Beach" class="trip-banner" />
      <div class="trip-title">Goa Trip</div>
      <button class="accordion">Days / Nights</button>
      <div class="panel"><ul id="daysList"><li data-days="3" data-nights="2">2 Nights / 3 Days</li><li data-days="4" data-nights="3">3 Nights / 4 Days</li><li data-days="5" data-nights="4">4 Nights / 5 Days</li></ul></div>
      <button class="accordion">Passengers</button>
      <div class="panel">
        <div class="pax-inputs" id="paxInputs">
          <label for="adultCount">
            Adults:
            <div class="input-group">
              <button class="btn-decrement" onclick="decrementAdult()">-</button>
              <input type="number" id="adultCount" min="1" max="10" value="1" class="number-input" />
              <button class="btn-increment" onclick="incrementAdult()">+</button>
            </div>
            <div class="pax-count-display" id="adultDisplay">1 Adult</div>
          </label>
          <label for="childCount">
            Children:
            <div class="input-group">
              <button class="btn-decrement" onclick="decrementChild()">-</button>
              <input type="number" id="childCount" min="0" max="10" value="0" class="number-input" />
              <button class="btn-increment" onclick="incrementChild()">+</button>
            </div>
            <div class="pax-count-display" id="childDisplay">0 Children</div>
          </label>
        </div>
      </div>
      <button class="accordion">Pickup and Drop</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Transportation" data-key="pickup">
            <span class="item-name">Pickup</span>
            <span class="transfer-price" id="pickupPriceDisplay"></span>
            <div class="transfer-selection-hint">Click to select pickup option</div>
          </li>
          <ul class="sublist">
            <li class="transfer-option" data-transfer="airport" data-type="pickup" data-price="750">Airport Pickup (‚Çπ750 per person)</li>
            <li class="transfer-option" data-transfer="railway" data-type="pickup" data-price="750">Railway Station Pickup (‚Çπ750 per person)</li>
          </ul>
          <li class="toggle-sublist" data-category="Transportation" data-key="drop">
            <span class="item-name">Drop</span>
            <span class="transfer-price" id="dropPriceDisplay"></span>
            <div class="transfer-selection-hint">Click to select drop option</div>
          </li>
          <ul class="sublist">
            <li class="transfer-option" data-transfer="airport" data-type="drop" data-price="750">Airport Drop (‚Çπ750 per person)</li>
            <li class="transfer-option" data-transfer="railway" data-type="drop" data-price="750">Railway Station Drop (‚Çπ750 per person)</li>
          </ul>
        </ul>
      </div>
      <button class="accordion">Hotel</button>
      <div class="panel">
        <ul>
          <li class="hotel-option" data-price="1600" data-type="casaMaria" data-category="Hotel"><span class="item-name">Casa Maria</span><span class="item-price" style="margin-left: 20px;">‚Çπ1600 per person</span></li>
          <li class="hotel-option" data-price="1900" data-type="mayfieldBoutique" data-category="Hotel"><span class="item-name">Mayfield Boutique</span><span class="item-price" style="margin-left: 20px;">‚Çπ1900 per person</span></li>
          <li class="hotel-option" data-price="2200" data-type="rivasaResort" data-category="Hotel"><span class="item-name">Rivasa Resort</span><span class="item-price" style="margin-left: 20px;">‚Çπ2200 per person</span></li>
        </ul>
        <div id="hotelDetails" class="sub-section" style="text-align:center; margin-top:10px; display:none;"></div>
      </div>
      <button class="accordion">Sightseeing</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="northGoa"><span class="item-name">North Goa Tour</span><span class="item-price" style="margin-left:20px;">Free</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="southGoa"><span class="item-name">South Goa Tour</span><span class="item-price" style="margin-left:20px;">Free</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="grandIslandFullDay"><span class="item-name">Grand Island Full Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1800</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="grandIslandHalfDay"><span class="item-name">Grand Island Half Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="malvanFullDay"><span class="item-name">Malvan Full Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1800</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="malvanHalfDay"><span class="item-name">Malvan Half Day Adventure Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <ul class="sublist">
          </ul>
          <li class="toggle-sublist" data-category="Sightseeing" data-package="dudhsagarWaterfalls"><span class="item-name">Dudhsagar Waterfalls</span><span class="item-price" style="margin-left:20px;">‚Çπ2000</span></li>
          <ul class="sublist">
          </ul>
        </ul>
      </div>
      <button class="accordion">Otheractivities</button>
      <div class="panel">
        <ul>
          <li class="toggle-sublist" data-category="Other Activities" data-package="dinnerCruise"><span class="item-name">Dinner Cruise</span><span class="item-price" style="margin-left:20px;">‚Çπ1200</span></li>
          <li class="toggle-sublist" data-category="Other Activities" data-package="dudhsagarFullDay"><span class="item-name">Doodhsagar Full Day Trip</span><span class="item-price" style="margin-left:20px;">‚Çπ2000</span></li>
          <li class="toggle-sublist" data-category="Other Activities" data-package="casinoBigDaddyy"><span class="item-name">Casino at Big Daddyy</span><span class="item-price" style="margin-left:20px;">‚Çπ4000</span></li>
        </ul>
      </div>
      <button class="accordion">Food</button>
      <div class="panel">
        <div class="food-option" data-type="breakfast" data-category="Food" data-price="300">
          <span class="food-option-name">Breakfast</span>
          <span class="food-option-price">‚Çπ300 per person</span>
        </div>
        <div class="food-option" data-type="lunch" data-category="Food" data-price="700">
          <span class="food-option-name">Lunch</span>
          <span class="food-option-price">‚Çπ700 per person</span>
        </div>
        <div class="food-option" data-type="dinner" data-category="Food" data-price="700">
          <span class="food-option-name">Dinner</span>
          <span class="food-option-price">‚Çπ700 per person</span>
        </div>
      </div>
      <div class="summary-box"><h4>Selected Items:</h4><div id="selectedItems">None</div></div>
      <div class="total" id="totalAmount">Grand Total: ‚Çπ0</div>
      <div class="button-group"><a href="#" id="previewBtn" class="btn-preview">üîç Preview</a></div>
    </div>
  `;
  initializeEventListeners();
  // Initialize prices after loading
  setTimeout(() => {
    updateDynamicPrices();
  }, 100);
}

// --- PASSENGER COUNT FUNCTIONS ---
function incrementAdult() {
  const input = document.getElementById("adultCount");
  const value = parseInt(input.value) || 0;
  if (value < 10) {
    input.value = value + 1;
    onPaxChanged();
  }
}

function decrementAdult() {
  const input = document.getElementById("adultCount");
  const value = parseInt(input.value) || 0;
  if (value > 1) {
    input.value = value - 1;
    onPaxChanged();
  }
}

function incrementChild() {
  const input = document.getElementById("childCount");
  const value = parseInt(input.value) || 0;
  if (value < 10) {
    input.value = value + 1;
    onPaxChanged();
  }
}

function decrementChild() {
  const input = document.getElementById("childCount");
  const value = parseInt(input.value) || 0;
  if (value > 0) {
    input.value = value - 1;
    onPaxChanged();
  }
}

// --- EVENT HANDLING & LOGIC ---
function initializeEventListeners() {
  const acc = document.getElementsByClassName("accordion");
  for (let i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      for (let j = 0; j < acc.length; j++) { if (j !== i) { acc[j].classList.remove("active"); acc[j].nextElementSibling.classList.remove("show"); } }
      this.classList.toggle("active"); this.nextElementSibling.classList.toggle("show");
    });
  }

  document.querySelectorAll(".panel li.toggle-sublist").forEach(title => {
    title.addEventListener("click", (e) => {
      e.stopPropagation();
      
      // Special handling for transfer toggles
      const key = title.getAttribute('data-key');
      if (key === 'pickup' || key === 'drop') {
        const isAlreadySelected = title.classList.contains("selected");
        
        if (isAlreadySelected) {
          // Unselect transfer
          unselectTransfer(key);
        } else {
          // Just expand/collapse sublist normally
          const siblingList = title.nextElementSibling;
          if (siblingList && siblingList.classList.contains('sublist')) {
            siblingList.classList.toggle("show");
          }
        }
      } else {
        // Normal toggle behavior for other items
        const siblingList = title.nextElementSibling;
        if (siblingList && siblingList.classList.contains('sublist')) {
          siblingList.classList.toggle("show");
          
          // If it's a sightseeing sublist, add horizontal slider and transport options
          const packageKey = title.getAttribute('data-package');
          if (packageKey && title.getAttribute('data-category') === 'Sightseeing') {
            addSightseeingContent(title, packageKey);
          }
        }
      }
    });
  });

  // Add event listeners for transfer options
  document.querySelectorAll(".transfer-option").forEach(option => {
    option.addEventListener("click", (e) => {
      e.stopPropagation();
      selectTransfer(option);
    });
  });

  document.querySelectorAll("#daysList li").forEach(dayLi => { 
    dayLi.addEventListener("click", () => onDaysSelected(dayLi)); 
  });
  // Removed default selection for days/nights

  // Multiple event listeners for passenger count to ensure mobile compatibility
  const adultInput = document.getElementById("adultCount");
  const childInput = document.getElementById("childCount");
  
  if (adultInput) {
    adultInput.addEventListener("input", onPaxChanged);
    adultInput.addEventListener("change", onPaxChanged);
    adultInput.addEventListener("blur", onPaxChanged);
    adultInput.addEventListener("touchend", onPaxChanged);
  }
  
  if (childInput) {
    childInput.addEventListener("input", onPaxChanged);
    childInput.addEventListener("change", onPaxChanged);
    childInput.addEventListener("blur", onPaxChanged);
    childInput.addEventListener("touchend", onPaxChanged);
  }

  // Add event listeners for all clickable items including food
  document.querySelectorAll(".panel li, .food-option").forEach(item => {
    if (item.closest("#daysList")) return;
    item.addEventListener("click", e => { 
      e.stopPropagation(); 
      handleItemClick(item); 
    });
  });

  const previewBtn = document.getElementById("previewBtn");
  if (previewBtn) {
    previewBtn.addEventListener("click", (e) => { e.preventDefault(); generatePreview(); });
  }
}

// Add sightseeing content with horizontal slider and transport options
function addSightseeingContent(titleElement, packageKey) {
  const sublist = titleElement.nextElementSibling;
  
  // Check if content already added
  if (sublist.querySelector('.sightseeing-slider-container')) return;
  
  // Initialize current slide for this package if not already
  if (!currentSightseeingSlides[packageKey]) {
    currentSightseeingSlides[packageKey] = 0;
  }
  
  // Create horizontal slider container
  const sliderContainer = document.createElement('div');
  sliderContainer.className = 'sightseeing-slider-container';
  sliderContainer.innerHTML = `
    <div class="sightseeing-slider" id="sightseeing-slider-${packageKey}">
      ${sightseeingPlaces[packageKey].map(place => `
        <div class="sightseeing-card">
          <img src="${place.image}" alt="${place.name}">
          <div class="place-name">${place.name}</div>
        </div>
      `).join('')}
    </div>
    <button class="sightseeing-slider-arrow left" onclick="changeSightseeingSlide('${packageKey}', -1)">&lt;</button>
    <button class="sightseeing-slider-arrow right" onclick="changeSightseeingSlide('${packageKey}', 1)">&gt;</button>
  `;
  
  // Create transport options
  const transportSection = document.createElement('div');
  transportSection.className = 'sightseeing-transport';
  transportSection.innerHTML = `
    <h5>Transportation Options</h5>
    <div class="transport-options">
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="ownTransfer">Own Transfer</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="privateBike">Private Bike</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="cabWithDriver">Cab with Driver</button>
      <button class="transport-option-btn" data-package="${packageKey}" data-transport="cabWithoutDriver">Cab without Driver</button>
    </div>
    <div class="bike-selection" id="bike-selection-${packageKey}">
      <div class="bike-selection-label">Number of Bikes (‚Çπ500 per bike):</div>
      <div class="bike-input-group">
        <button class="btn-decrement" onclick="decrementBike('${packageKey}')">-</button>
        <input type="number" id="bike-count-${packageKey}" class="bike-input" min="1" max="10" value="1">
        <button class="btn-increment" onclick="incrementBike('${packageKey}')">+</button>
        <span class="bike-price-display" id="bike-price-${packageKey}">‚Çπ500</span>
      </div>
    </div>
    <div class="cab-selection" id="cab-selection-${packageKey}">
      <div class="cab-selection-label">Number of Cabs (‚Çπ2000 per cab with driver / ‚Çπ1800 per cab without driver):</div>
      <div class="cab-input-group">
        <button class="btn-decrement" onclick="decrementCab('${packageKey}')">-</button>
        <input type="number" id="cab-count-${packageKey}" class="cab-input" min="1" max="10" value="1">
        <button class="btn-increment" onclick="incrementCab('${packageKey}')">+</button>
        <span class="cab-price-display" id="cab-price-${packageKey}">‚Çπ2000</span>
      </div>
    </div>
  `;
  
  // Insert after existing list items (which are now empty)
  sublist.appendChild(sliderContainer);
  sublist.appendChild(transportSection);
  
  // Set initial slider position
  updateSightseeingSliderPosition(packageKey);
  
  // Add event listeners for transport options
  transportSection.querySelectorAll('.transport-option-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      selectSightseeingTransport(btn);
    });
  });
  
  // Add event listener for bike count input
  const bikeInput = transportSection.querySelector(`#bike-count-${packageKey}`);
  if (bikeInput) {
    bikeInput.addEventListener('input', () => updateBikeCount(packageKey));
    bikeInput.addEventListener('change', () => updateBikeCount(packageKey));
  }
  
  // Add event listener for cab count input
  const cabInput = transportSection.querySelector(`#cab-count-${packageKey}`);
  if (cabInput) {
    cabInput.addEventListener('input', () => updateCabCount(packageKey));
    cabInput.addEventListener('change', () => updateCabCount(packageKey));
  }
  
  // Check if a transport option was previously selected for this package
  if (selectedSightseeingTransport[packageKey]) {
    const selectedBtn = transportSection.querySelector(`[data-transport="${selectedSightseeingTransport[packageKey]}"]`);
    if (selectedBtn) {
      selectedBtn.classList.add('selected');
      // Show appropriate selection based on transport type
      if (selectedSightseeingTransport[packageKey] === 'privateBike') {
        const bikeSelection = transportSection.querySelector(`#bike-selection-${packageKey}`);
        if (bikeSelection) {
          bikeSelection.classList.add('show');
          // Set bike count from saved value
          const savedCount = bikeCounts[packageKey] || 1;
          bikeInput.value = savedCount;
          updateBikePrice(packageKey);
        }
      } else if (selectedSightseeingTransport[packageKey] === 'cabWithDriver' || selectedSightseeingTransport[packageKey] === 'cabWithoutDriver') {
        const cabSelection = transportSection.querySelector(`#cab-selection-${packageKey}`);
        if (cabSelection) {
          cabSelection.classList.add('show');
          // Set cab count from saved value
          const savedCount = cabCounts[packageKey] || 1;
          cabInput.value = savedCount;
          updateCabPrice(packageKey);
        }
      }
    }
  }
}

// Bike count functions
function incrementBike(packageKey) {
  const input = document.getElementById(`bike-count-${packageKey}`);
  if (input) {
    const value = parseInt(input.value) || 0;
    if (value < 10) {
      input.value = value + 1;
      updateBikeCount(packageKey);
    }
  }
}

function decrementBike(packageKey) {
  const input = document.getElementById(`bike-count-${packageKey}`);
  if (input) {
    const value = parseInt(input.value) || 0;
    if (value > 1) {
      input.value = value - 1;
      updateBikeCount(packageKey);
    }
  }
}

function updateBikeCount(packageKey) {
  const input = document.getElementById(`bike-count-${packageKey}`);
  if (input) {
    const count = Math.max(1, parseInt(input.value) || 1);
    input.value = count;
    bikeCounts[packageKey] = count;
    updateBikePrice(packageKey);
    updateSightseeingTransportInSelection(packageKey, 'privateBike');
    
    // Update display for North Goa and South Goa
    updateNorthSouthGoaDisplay(packageKey);
  }
}

function updateBikePrice(packageKey) {
  const count = bikeCounts[packageKey] || 1;
  const priceDisplay = document.getElementById(`bike-price-${packageKey}`);
  if (priceDisplay) {
    priceDisplay.textContent = formatPrice(PRICES.sightseeingTransport.privateBike * count);
  }
}

// Cab count functions
function incrementCab(packageKey) {
  const input = document.getElementById(`cab-count-${packageKey}`);
  if (input) {
    const value = parseInt(input.value) || 0;
    if (value < 10) {
      input.value = value + 1;
      updateCabCount(packageKey);
    }
  }
}

function decrementCab(packageKey) {
  const input = document.getElementById(`cab-count-${packageKey}`);
  if (input) {
    const value = parseInt(input.value) || 0;
    if (value > 1) {
      input.value = value - 1;
      updateCabCount(packageKey);
    }
  }
}

function updateCabCount(packageKey) {
  const input = document.getElementById(`cab-count-${packageKey}`);
  if (input) {
    const count = Math.max(1, parseInt(input.value) || 1);
    input.value = count;
    cabCounts[packageKey] = count;
    updateCabPrice(packageKey);
    updateSightseeingTransportInSelection(packageKey, selectedSightseeingTransport[packageKey]);
    
    // Update display for North Goa and South Goa
    updateNorthSouthGoaDisplay(packageKey);
  }
}

function updateCabPrice(packageKey) {
  const count = cabCounts[packageKey] || 1;
  const transportType = selectedSightseeingTransport[packageKey];
  const pricePerCab = transportType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
  const priceDisplay = document.getElementById(`cab-price-${packageKey}`);
  if (priceDisplay) {
    priceDisplay.textContent = formatPrice(pricePerCab * count);
  }
}

// Update display for North Goa and South Goa to show bike/cab count
function updateNorthSouthGoaDisplay(packageKey) {
  // Only update for North Goa and South Goa
  if (packageKey !== 'northGoa' && packageKey !== 'southGoa') return;
  
  const tourElement = document.querySelector(`[data-package="${packageKey}"]`);
  if (!tourElement) return;
  
  const priceSpan = tourElement.querySelector('.item-price');
  if (!priceSpan) return;
  
  // Check what transport type is selected
  if (selectedSightseeingTransport[packageKey] === 'privateBike') {
    const bikeCount = bikeCounts[packageKey] || 1;
    const bikePrice = PRICES.sightseeingTransport.privateBike * bikeCount;
    priceSpan.textContent = `${bikeCount} Bike${bikeCount > 1 ? 's' : ''} (${formatPrice(bikePrice)})`;
  } else if (selectedSightseeingTransport[packageKey] === 'cabWithDriver' || selectedSightseeingTransport[packageKey] === 'cabWithoutDriver') {
    const cabCount = cabCounts[packageKey] || 1;
    const cabType = selectedSightseeingTransport[packageKey];
    const pricePerCab = cabType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
    const cabPrice = pricePerCab * cabCount;
    const cabTypeName = cabType === 'cabWithDriver' ? 'Cab with Driver' : 'Cab without Driver';
    priceSpan.textContent = `${cabCount} ${cabTypeName} (${formatPrice(cabPrice)})`;
  } else {
    priceSpan.textContent = "Free";
  }
}

// Change sightseeing slide
function changeSightseeingSlide(packageKey, direction) {
  const places = sightseeingPlaces[packageKey];
  if (!places || places.length === 0) return;
  
  // Calculate how many cards can fit in container
  const slider = document.getElementById(`sightseeing-slider-${packageKey}`);
  if (!slider) return;
  
  const containerWidth = slider.parentElement.offsetWidth;
  const cardWidth = 175; // 160px card width + 15px gap
  const visibleCards = Math.floor(containerWidth / cardWidth);
  const maxSlide = Math.max(0, places.length - visibleCards);
  
  currentSightseeingSlides[packageKey] += direction;
  
  // Boundary check
  if (currentSightseeingSlides[packageKey] < 0) {
    currentSightseeingSlides[packageKey] = 0;
  } else if (currentSightseeingSlides[packageKey] > maxSlide) {
    currentSightseeingSlides[packageKey] = maxSlide;
  }
  
  updateSightseeingSliderPosition(packageKey);
}

// Update sightseeing slider position
function updateSightseeingSliderPosition(packageKey) {
  const slider = document.getElementById(`sightseeing-slider-${packageKey}`);
  if (!slider) return;
  
  const cardWidth = 175; // 160px card width + 15px gap
  slider.style.transform = `translateX(-${currentSightseeingSlides[packageKey] * cardWidth}px)`;
}

// Select sightseeing transport
function selectSightseeingTransport(btn) {
  const packageKey = btn.getAttribute('data-package');
  const transportType = btn.getAttribute('data-transport');
  
  // Clear previous selection for this package
  btn.parentElement.querySelectorAll('.transport-option-btn').forEach(b => {
    b.classList.remove('selected');
  });
  
  // Mark current selection
  btn.classList.add('selected');
  
  // Show/hide selection based on transport type
  const bikeSelection = document.getElementById(`bike-selection-${packageKey}`);
  const cabSelection = document.getElementById(`cab-selection-${packageKey}`);
  
  // Hide all selection options first
  if (bikeSelection) bikeSelection.classList.remove('show');
  if (cabSelection) cabSelection.classList.remove('show');
  
  // Show appropriate selection
  if (transportType === 'privateBike') {
    if (bikeSelection) {
      bikeSelection.classList.add('show');
      // Initialize bike count if not already set
      if (!bikeCounts[packageKey]) {
        bikeCounts[packageKey] = 1;
        const bikeInput = document.getElementById(`bike-count-${packageKey}`);
        if (bikeInput) bikeInput.value = 1;
        updateBikePrice(packageKey);
      }
    }
  } else if (transportType === 'cabWithDriver' || transportType === 'cabWithoutDriver') {
    if (cabSelection) {
      cabSelection.classList.add('show');
      // Initialize cab count if not already set
      if (!cabCounts[packageKey]) {
        cabCounts[packageKey] = 1;
        const cabInput = document.getElementById(`cab-count-${packageKey}`);
        if (cabInput) cabInput.value = 1;
        updateCabPrice(packageKey);
      }
    }
  }
  
  // Update selected transport
  selectedSightseeingTransport[packageKey] = transportType;
  
  // Update display for North Goa and South Goa
  updateNorthSouthGoaDisplay(packageKey);
  
  // Update selected items
  updateSightseeingTransportInSelection(packageKey, transportType);
}

// Update sightseeing transport in selected items
function updateSightseeingTransportInSelection(packageKey, transportType) {
  // Find sightseeing item in selectedItems
  const sightseeingItem = selectedItems.find(item => 
    item.category === 'Sightseeing' && item.type === packageKey
  );
  
  if (sightseeingItem) {
    // Update transport type
    sightseeingItem.transport = transportType;
    
    // Update price based on transport type
    let transportPrice = 0;
    if (transportType === 'privateBike') {
      const bikeCount = bikeCounts[packageKey] || 1;
      transportPrice = PRICES.sightseeingTransport[transportType] * bikeCount;
    } else if (transportType === 'cabWithDriver' || transportType === 'cabWithoutDriver') {
      const cabCount = cabCounts[packageKey] || 1;
      const pricePerCab = transportType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
      transportPrice = pricePerCab * cabCount;
    } else {
      transportPrice = PRICES.sightseeingTransport[transportType];
    }
    
    const basePrice = PRICES.sightseeingPackage[packageKey];
    const totalPeople = adultCount + (childCount * 0.5);
    
    sightseeingItem.price = (basePrice + transportPrice) * totalPeople;
    sightseeingItem.transportPrice = transportPrice * totalPeople;
    sightseeingItem.bikeCount = transportType === 'privateBike' ? (bikeCounts[packageKey] || 1) : 0;
    sightseeingItem.cabCount = (transportType === 'cabWithDriver' || transportType === 'cabWithoutDriver') ? (cabCounts[packageKey] || 1) : 0;
  }
  
  updateSummary();
}

// Function to unselect transfer
function unselectTransfer(key) {
  // Clear all transfer selections for this type
  document.querySelectorAll(`.transfer-option[data-type="${key}"]`).forEach(opt => {
    opt.classList.remove("selected");
  });
  
  // Reset selected transfer
  if (key === 'pickup') {
    selectedPickup = "";
  } else if (key === 'drop') {
    selectedDrop = "";
  }
  
  // Remove transfer from selected items
  selectedItems = selectedItems.filter(item => item.key !== key);
  
  // Reset parent list item
  const transferLi = document.querySelector(`[data-key="${key}"]`);
  if (transferLi) {
    transferLi.classList.remove("selected");
    document.getElementById(`${key}PriceDisplay`).textContent = "";
    // Show hint text
    const hint = transferLi.querySelector(".transfer-selection-hint");
    if (hint) hint.style.display = "block";
  }
  
  updateSummary();
}

// Handle transfer selection
function selectTransfer(option) {
  const type = option.getAttribute("data-type");
  const transfer = option.getAttribute("data-transfer");
  const basePrice = parseInt(option.getAttribute("data-price"));
  
  // Clear previous selection for this type
  document.querySelectorAll(`.transfer-option[data-type="${type}"]`).forEach(opt => {
    opt.classList.remove("selected");
  });
  
  // Mark current selection
  option.classList.add("selected");
  
  // Update selected transfer
  if (type === 'pickup') {
    selectedPickup = transfer;
  } else if (type === 'drop') {
    selectedDrop = transfer;
  }
  
  // Remove previous transfer from selected items if exists
  selectedItems = selectedItems.filter(item => item.key !== type);
  
  // Calculate price based on adults (‚Çπ750 per person, which is ‚Çπ3000 for 4 people)
  const price = basePrice * adultCount;
  
  // Add to selected items
  selectedItems.push({
    name: `${type.charAt(0).toUpperCase() + type.slice(1)} (${transfer.charAt(0).toUpperCase() + transfer.slice(1)})`,
    price: price,
    category: "Transportation",
    key: type,
    type: transfer
  });
  
  // Update parent list item to show selected
  const parentLi = option.closest(".sublist").previousElementSibling;
  if (parentLi) {
    parentLi.classList.add("selected");
    document.getElementById(`${type}PriceDisplay`).textContent = formatPrice(price);
    // Hide hint text
    const hint = parentLi.querySelector(".transfer-selection-hint");
    if (hint) hint.style.display = "none";
  }
  
  updateSummary();
}

function onDaysSelected(li) {
  daysSelected = parseInt(li.dataset.days); nightsSelected = parseInt(li.dataset.nights);
  document.querySelectorAll("#daysList li").forEach(d => d.classList.remove("selected"));
  li.classList.add("selected");
  clearSelectionsExceptDaysAndPax();
  updateDynamicPrices();
  updateSummary();
}

function onPaxChanged() {
  const adultInput = document.getElementById("adultCount");
  const childInput = document.getElementById("childCount");
  adultCount = Math.max(1, parseInt(adultInput.value) || 1);
  childCount = Math.max(0, parseInt(childInput.value) || 0);
  adultInput.value = adultCount; 
  childInput.value = childCount;
  
  // Update display text
  const adultDisplay = document.getElementById("adultDisplay");
  const childDisplay = document.getElementById("childDisplay");
  if (adultDisplay) adultDisplay.textContent = `${adultCount} Adult${adultCount > 1 ? 's' : ''}`;
  if (childDisplay) childDisplay.textContent = `${childCount} Child${childCount !== 1 ? 'ren' : ''}`;
  
  updateDynamicPrices();
  
  // Update hotel price if a hotel is selected
  const hotelItem = selectedItems.find(item => item.category === "Hotel");
  if (hotelItem) {
    const perPersonPrice = PRICES.hotelPerNight[hotelItem.type];
    const totalPeople = adultCount + childCount;
    hotelItem.price = perPersonPrice * totalPeople;
    hotelItem.perPersonPrice = perPersonPrice;
  }
  
  // Update transfer prices if selected
  if (selectedPickup) {
    const transferOption = document.querySelector(`.transfer-option[data-type="pickup"][data-transfer="${selectedPickup}"]`);
    if (transferOption) {
      selectTransfer(transferOption);
    }
  }
  
  if (selectedDrop) {
    const transferOption = document.querySelector(`.transfer-option[data-type="drop"][data-transfer="${selectedDrop}"]`);
    if (transferOption) {
      selectTransfer(transferOption);
    }
  }
  
  // Update food prices
  selectedItems.forEach(item => {
    if (item.category === "Food") {
      const perPersonPrice = PRICES.food[item.type];
      item.price = perPersonPrice * adultCount + Math.floor(perPersonPrice * 0.5) * childCount;
      item.perPersonPrice = perPersonPrice;
    }
  });
  
  // Update sightseeing prices
  selectedItems.forEach(item => {
    if (item.category === "Sightseeing") {
      const basePrice = PRICES.sightseeingPackage[item.type];
      let transportPrice = 0;
      
      if (item.transport === 'privateBike') {
        const bikeCount = bikeCounts[item.type] || 1;
        transportPrice = PRICES.sightseeingTransport[item.transport] * bikeCount;
      } else if (item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') {
        const cabCount = cabCounts[item.type] || 1;
        const pricePerCab = item.transport === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
        transportPrice = pricePerCab * cabCount;
      } else {
        transportPrice = item.transport ? PRICES.sightseeingTransport[item.transport] : 0;
      }
      
      const totalPeople = adultCount + (childCount * 0.5);
      
      item.price = (basePrice + transportPrice) * totalPeople;
      item.transportPrice = transportPrice * totalPeople;
    }
  });
  
  updateSummary();
}

function handleItemClick(item) {
  const nameSpan = item.querySelector('.item-name');
  const itemName = nameSpan ? nameSpan.textContent.trim() : item.textContent.trim();
  
  const itemPrice = Number(item.getAttribute("data-price")) || 0;
  const category = item.getAttribute("data-category") || "Others";
  const isHotel = item.classList.contains("hotel-option");
  const isFood = item.classList.contains("food-option");
  const isSightseeing = item.classList.contains("toggle-sublist") && item.getAttribute("data-category") === "Sightseeing";
  const isOtherActivity = item.classList.contains("toggle-sublist") && item.getAttribute("data-category") === "Other Activities";
  const type = item.getAttribute("data-type") || item.getAttribute("data-package");

  if (item.classList.contains("selected")) {
    // If clicking on an already selected item, unselect it
    item.classList.remove("selected");
    selectedItems = selectedItems.filter(i => i.name !== itemName);
    if (isHotel) document.getElementById("hotelDetails").style.display = "none";
  } else {
    // For hotel, only allow one selection at a time
    if (isHotel) { 
      document.querySelectorAll('.hotel-option.selected').forEach(el => el.classList.remove('selected')); 
      selectedItems = selectedItems.filter(i => i.category !== "Hotel"); 
      
      // Calculate total hotel price for all people
      const perPersonPrice = PRICES.hotelPerNight[type];
      const totalPeople = adultCount + childCount;
      const totalHotelPrice = perPersonPrice * totalPeople;
      
      // Add to selected items with calculated total price
      selectedItems.push({ 
        name: itemName, 
        price: totalHotelPrice, 
        category: category, 
        type: type,
        perPersonPrice: perPersonPrice
      });
    }
    
    // For food option, toggle selection
    if (isFood) {
      item.classList.add("selected");
      selectedItems = selectedItems.filter(i => i.category !== "Food" || i.type !== type);
      
      const perPersonPrice = PRICES.food[type];
      const totalPrice = perPersonPrice * adultCount + Math.floor(perPersonPrice * 0.5) * childCount;
      
      selectedItems.push({ 
        name: itemName, 
        price: totalPrice, 
        category: category, 
        type: type,
        perPersonPrice: perPersonPrice
      });
    } else if (!isHotel && !isFood) {
      item.classList.add("selected");
      selectedItems = selectedItems.filter(i => i.name !== itemName);
      
      // For sightseeing, add with default transport (own transfer)
      if (isSightseeing) {
        const basePrice = PRICES.sightseeingPackage[type];
        const transportPrice = 0; // Default to own transfer
        const totalPeople = adultCount + (childCount * 0.5);
        
        selectedItems.push({ 
          name: itemName, 
          price: (basePrice + transportPrice) * totalPeople, 
          category: category, 
          type: type,
          transport: 'ownTransfer',
          transportPrice: 0,
          bikeCount: 0,
          cabCount: 0
        });
        
        // Initialize transport selection
        selectedSightseeingTransport[type] = 'ownTransfer';
      } else {
        selectedItems.push({ name: itemName, price: itemPrice, category: category, type: type });
      }
    }
  }

  if (isHotel) {
    item.classList.add("selected");
    showHotelDetails(type);
  }
  updateSummary();
}

// --- DYNAMIC UI UPDATES ---
function updateDynamicPrices() {
  // Update hotel prices based on total people
  document.querySelectorAll(".hotel-option").forEach(el => {
    const type = el.getAttribute("data-type");
    if (type && PRICES.hotelPerNight[type]) {
      // Calculate total price for all people
      const perPersonPrice = PRICES.hotelPerNight[type];
      const totalPeople = adultCount + childCount;
      const totalPrice = perPersonPrice * totalPeople;
      el.setAttribute("data-price", totalPrice); 
      const priceSpan = el.querySelector(".item-price");
      if (priceSpan) {
        // Keep showing per person price in display
        priceSpan.textContent = formatPrice(PRICES.hotelPerNight[type]) + " per person";
      }
    }
  });

  document.querySelectorAll('[data-category="Sightseeing"]').forEach(el => {
    const packageKey = el.getAttribute('data-package');
    if (packageKey && PRICES.sightseeingPackage[packageKey] !== undefined) {
      const basePrice = PRICES.sightseeingPackage[packageKey];
      let transportPrice = 0;
      
      if (selectedSightseeingTransport[packageKey] === 'privateBike') {
        const bikeCount = bikeCounts[packageKey] || 1;
        transportPrice = PRICES.sightseeingTransport.privateBike * bikeCount;
      } else if (selectedSightseeingTransport[packageKey] === 'cabWithDriver' || selectedSightseeingTransport[packageKey] === 'cabWithoutDriver') {
        const cabCount = cabCounts[packageKey] || 1;
        const pricePerCab = selectedSightseeingTransport[packageKey] === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
        transportPrice = pricePerCab * cabCount;
      } else if (selectedSightseeingTransport[packageKey]) {
        transportPrice = PRICES.sightseeingTransport[selectedSightseeingTransport[packageKey]];
      }
      
      const totalPeople = adultCount + (childCount * 0.5);
      
      const price = (basePrice + transportPrice) * totalPeople;
      el.setAttribute("data-price", Math.round(price));
      const priceSpan = el.querySelector(".item-price");
      if (priceSpan) {
        // For North Goa and South Goa, show bike/cab count if selected
        if (packageKey === 'northGoa' || packageKey === 'southGoa') {
          if (selectedSightseeingTransport[packageKey] === 'privateBike') {
            const bikeCount = bikeCounts[packageKey] || 1;
            const bikePrice = PRICES.sightseeingTransport.privateBike * bikeCount;
            priceSpan.textContent = `${bikeCount} Bike${bikeCount > 1 ? 's' : ''} (${formatPrice(bikePrice)})`;
          } else if (selectedSightseeingTransport[packageKey] === 'cabWithDriver' || selectedSightseeingTransport[packageKey] === 'cabWithoutDriver') {
            const cabCount = cabCounts[packageKey] || 1;
            const cabType = selectedSightseeingTransport[packageKey];
            const pricePerCab = cabType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
            const cabPrice = pricePerCab * cabCount;
            const cabTypeName = cabType === 'cabWithDriver' ? 'Cab with Driver' : 'Cab without Driver';
            priceSpan.textContent = `${cabCount} ${cabTypeName} (${formatPrice(cabPrice)})`;
          } else {
            priceSpan.textContent = "Free";
          }
        } else {
          priceSpan.textContent = formatPrice(Math.round(price));
        }
      } else {
        priceSpan.textContent = formatPrice(Math.round(price));
      }
    }
  });

  document.querySelectorAll('[data-category="Other Activities"]').forEach(el => {
    const packageKey = el.getAttribute('data-package');
    if (packageKey && PRICES.otherActivities[packageKey]) {
      const price = PRICES.otherActivities[packageKey] * (adultCount + (childCount * 0.5));
      el.setAttribute("data-price", Math.round(price));
      const priceSpan = el.querySelector(".item-price");
      if (priceSpan) {
        priceSpan.textContent = formatPrice(Math.round(price));
      }
    }
  });
}

function updateSummary() {
  if (selectedItems.length === 0) {
    document.getElementById("selectedItems").innerHTML = "None";
    document.getElementById("totalAmount").textContent = "Grand Total: ‚Çπ0"; totalAmount = 0; return;
  }
  const categories = {}; totalAmount = 0;
  selectedItems.forEach(item => { if (!categories[item.category]) categories[item.category] = []; categories[item.category].push(item); });
  let html = "";
  
  // Add trip duration to summary
  html += `<div class="summary-category">Trip Duration</div>`;
  html += `<div class="summary-item">${daysSelected} Days / ${nightsSelected} Nights</div>`;
  
  // Add passenger count to summary
  html += `<div class="summary-category">Passengers</div>`;
  html += `<div class="summary-item">${adultCount} Adult${adultCount > 1 ? 's' : ''}${childCount > 0 ? ', ' + childCount + ' Child' + (childCount > 1 ? 'ren' : '') : ''}</div>`;
  
  for (const category in categories) {
    html += `<div class="summary-category">${category}</div>`;
    categories[category].forEach(item => {
      let line = `${item.name}`;
      if (item.price > 0) {
        // For hotel, show per person rate and total
        if (category === "Hotel" && item.perPersonPrice) {
          const totalPeople = adultCount + childCount;
          line += ` (${formatPrice(item.perPersonPrice)} √ó ${totalPeople} people = ${formatPrice(item.price)})`;
        } else if (category === "Food" && item.perPersonPrice) {
          const childPrice = Math.floor(item.perPersonPrice * 0.5);
          line += ` (${formatPrice(item.perPersonPrice)} √ó ${adultCount} adults`;
          if (childCount > 0) {
            line += ` + ${formatPrice(childPrice)} √ó ${childCount} children`;
          }
          line += ` = ${formatPrice(item.price)})`;
        } else if (category === "Sightseeing") {
          const basePrice = PRICES.sightseeingPackage[item.type];
          const totalPeople = adultCount + (childCount * 0.5);
          
          // Special handling for free tours
          if (basePrice === 0) {
            line += ` (Free tour`;
            if (item.transport && item.transport !== 'ownTransfer') {
              if (item.transport === 'privateBike' && item.bikeCount > 0) {
                line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`;
              } else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) {
                const cabType = item.transport;
                const pricePerCab = cabType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
                line += ` + ${formatPrice(pricePerCab)} √ó ${item.cabCount} ${cabType}`;
              } else {
                line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${totalPeople} people for ${item.transport}`;
              }
            }
            line += ` = ${formatPrice(item.price)})`;
          } else {
            line += ` (${formatPrice(basePrice)} √ó ${totalPeople} people`;
            if (item.transport && item.transport !== 'ownTransfer') {
              if (item.transport === 'privateBike' && item.bikeCount > 0) {
                line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`;
              } else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) {
                const cabType = item.transport;
                const pricePerCab = cabType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
                line += ` + ${formatPrice(pricePerCab)} √ó ${item.cabCount} ${cabType}`;
              } else {
                line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${totalPeople} people for ${item.transport}`;
              }
            }
            line += ` = ${formatPrice(item.price)})`;
          }
        } else if (category === "Transportation" && (item.key === 'pickup' || item.key === 'drop')) {
          line += ` (${formatPrice(PRICES.transportation[item.key])} √ó ${adultCount} adults = ${formatPrice(item.price)})`;
        } else {
          line += ` (${formatPrice(item.price)})`;
        }
      } else {
        // For free items
        if (category === "Sightseeing" && PRICES.sightseeingPackage[item.type] === 0) {
          line += ` (Free tour`;
          if (item.transport && item.transport !== 'ownTransfer') {
            if (item.transport === 'privateBike' && item.bikeCount > 0) {
              line += ` + ${formatPrice(PRICES.sightseeingTransport.privateBike)} √ó ${item.bikeCount} bike${item.bikeCount > 1 ? 's' : ''}`;
            } else if ((item.transport === 'cabWithDriver' || item.transport === 'cabWithoutDriver') && item.cabCount > 0) {
              const cabType = item.transport;
              const pricePerCab = cabType === 'cabWithDriver' ? PRICES.sightseeingTransport.cabWithDriver : PRICES.sightseeingTransport.cabWithoutDriver;
              line += ` + ${formatPrice(pricePerCab)} √ó ${item.cabCount} ${cabType}`;
            } else {
              const totalPeople = adultCount + (childCount * 0.5);
              line += ` + ${formatPrice(PRICES.sightseeingTransport[item.transport])} √ó ${totalPeople} people for ${item.transport}`;
            }
          }
          line += ` = ${formatPrice(item.price)})`;
        } else {
          line += ` (Free)`;
        }
      }
      html += `<div class="summary-item" data-category="${item.category}" data-type="${item.type}">${line}</div>`;
      totalAmount += item.price;
    });
  }
  document.getElementById("selectedItems").innerHTML = html;
  document.getElementById("totalAmount").textContent = `Grand Total: ${formatPrice(totalAmount)}`;

  document.querySelectorAll('.summary-item').forEach(item => {
    item.addEventListener('click', () => {
      const category = item.dataset.category;
      const type = item.dataset.type;
      if (category === 'Hotel') showHotelDetails(type);
      if (category === 'Transportation' || category === 'Sightseeing' || category === 'Cruise' || category === 'Other Activities') {
        const accordion = [...document.querySelectorAll('.accordion')].find(acc => acc.textContent.toLowerCase().includes(category.toLowerCase()));
        if (accordion) {
          accordion.click();
          accordion.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }
    });
  });
}

function clearSelectionsExceptDaysAndPax() {
  document.querySelectorAll('.panel li.selected').forEach(el => { if (!el.closest("#daysList")) el.classList.remove('selected'); });
  document.querySelectorAll('.food-option.selected').forEach(el => el.classList.remove('selected'));
  selectedItems = [];
  selectedPickup = "";
  selectedDrop = "";
  selectedSightseeingTransport = {};
  bikeCounts = {};
  cabCounts = {};
  
  // Reset transfer selection hints
  document.querySelectorAll('[data-key="pickup"], [data-key="drop"]').forEach(li => {
    li.classList.remove("selected");
    const key = li.getAttribute('data-key');
    document.getElementById(`${key}PriceDisplay`).textContent = "";
    const hint = li.querySelector(".transfer-selection-hint");
    if (hint) hint.style.display = "block";
  });
  
  // Reset North Goa and South Goa displays
  ['northGoa', 'southGoa'].forEach(packageKey => {
    const tourElement = document.querySelector(`[data-package="${packageKey}"]`);
    if (tourElement) {
      const priceSpan = tourElement.querySelector('.item-price');
      if (priceSpan) {
        priceSpan.textContent = "Free";
      }
    }
  });
}

// --- DETAIL DISPLAY FUNCTIONS ---
function showHotelDetails(hotelType) {
  const detailsDiv = document.getElementById("hotelDetails");
  if (!hotelDetailsMap[hotelType]) return;
  currentHotelType = hotelType; currentHotelImageSlide = 0; currentHotelDetailSlide = 0;
  detailsDiv.style.display = "block";
  detailsDiv.innerHTML = `
    <div class="hotel-image-slider" style="position:relative;">
      <span class="slider-arrow left" onclick="prevHotelImageSlide()">&lt;</span>
      <img id="hotelImg" src="${hotelImages[hotelType][0]}" style="width:100%;border-radius:8px;display:block;margin-bottom:8px;">
      <span class="slider-arrow right" onclick="nextHotelImageSlide()">&gt;</span>
    </div>
    <div class="hotel-details-slider" style="position:relative;margin-top:4px;">
      <span class="slider-arrow left" onclick="prevHotelDetailSlide()">&lt;</span>
      <div id="hotelDetailSlideContent"></div>
      <span class="slider-arrow right" onclick="nextHotelDetailSlide()">&gt;</span>
    </div>
  `;
  renderHotelDetailSlide();
}

function renderHotelDetailSlide() {
  const data = hotelDetailsMap[currentHotelType];
  let html = currentHotelDetailSlide === 0
    ? `<h4 style="color:#003a78;">${data.title} Details</h4><p>${data.desc}</p>`
    : `<h4 style="color:#003a78;">Location</h4><p>${data.location}</p>`;
  document.getElementById("hotelDetailSlideContent").innerHTML = html;
}

function prevHotelImageSlide() { const images = hotelImages[currentHotelType] || []; if (images.length === 0) return; currentHotelImageSlide = (currentHotelImageSlide - 1 + images.length) % images.length; document.getElementById("hotelImg").src = images[currentHotelImageSlide]; }
function nextHotelImageSlide() { const images = hotelImages[currentHotelType] || []; if (images.length === 0) return; currentHotelImageSlide = (currentHotelImageSlide + 1) % images.length; document.getElementById("hotelImg").src = images[currentHotelImageSlide]; }
function prevHotelDetailSlide() { currentHotelDetailSlide = (currentHotelDetailSlide === 0) ? 1 : 0; renderHotelDetailSlide(); }
function nextHotelDetailSlide() { currentHotelDetailSlide = (currentHotelDetailSlide === 1) ? 0 : 1; renderHotelDetailSlide(); }

// --- PREVIEW GENERATION ---
function generatePreview() {
  const summaryHTML = document.getElementById("selectedItems").innerHTML;
  const totalText = document.getElementById("totalAmount").innerText;
  const previewWindow = window.open('', '', 'width=900,height=1200');

  let tableRows = '';
  
  if (summaryHTML.trim() === "" || summaryHTML.trim() === "None") {
    tableRows = "<p>No items selected.</p>";
  } else {
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = summaryHTML;
    let rows = [];
    let currentCat = '';
    
    tempDiv.childNodes.forEach(node => {
      if (node.classList && node.classList.contains('summary-category')) {
        currentCat = node.innerText;
      } else if (node.classList && node.classList.contains('summary-item')) {
        let nameText = node.innerText;
        let [name, price] = nameText.split(' (‚Çπ');
        price = price ? "‚Çπ" + price.replace(")", "") : "-";
        rows.push({category: currentCat, name: name, price: price});
      }
    });
    
    if(rows.length > 0) {
      tableRows = '<table id="previewTable"><thead><tr><th>Category</th><th>Item</th><th>Price</th></tr></thead><tbody>';
      rows.forEach(row => {
        tableRows += `<tr><td>${row.category || ''}</td><td>${row.name || ''}</td><td>${row.price || '-'}</td></tr>`;
      });
      tableRows += '</tbody></table>';
    }
  }

  previewWindow.document.write(`
<!DOCTYPE html>
<html>
<head>
<title>TT World - Trip Costs</title>
<style>
body{font-family:"Poppins",sans-serif;margin:0;padding:20px 40px;background:#fff;color:#222;line-height:1.4}
.top-header{background:#181e39;color:#fff;padding:35px 0 20px 0;position:relative;text-align:center;margin-bottom:30px;border-radius:8px}
.top-header .brand{font-size:2.4rem;font-weight:bold;color:#ffe128;letter-spacing:2px;display:block}
.top-header .subtitle{color:#ffe128;font-size:1.1rem;margin-top:6px;margin-bottom:30px;letter-spacing:1px;font-style:italic}
.top-header .section-icons{margin-bottom:15px}
.top-header .section-icons span{background:#ffe128;color:#222;border-radius:6px;margin:0 10px;padding:6px 16px;font-size:1rem;font-weight:500;display:inline-block}
.top-header .contacts{font-size:1rem;margin:10px 0 0;color:#fff}
.top-header .contacts span{margin:0 20px}
.top-header .address{margin-top:7px;font-size:0.92rem;color:#cfcfcf}
.yellow-bar{width:100%;background:#ffe128;padding:18px 0;text-align:center;margin:0 0 20px 0;border-radius:8px}
.yellow-bar span{font-size:2rem;font-weight:bold;color:#222;letter-spacing:2px}
.selected-list{max-width:700px;margin:0 auto;border:2px solid #007acc;border-radius:10px;padding:20px;background:#f9faff}
.selected-list h3{margin-bottom:15px;font-size:1.5rem;color:#007acc;text-align:center}
.selected-list table{width:100%;border-collapse:collapse;font-size:1.1rem}
.selected-list th,.selected-list td{padding:10px 12px;border-bottom:1px solid #ddd;text-align:left}
.selected-list th{background:#e0e9f8;color:#222;font-weight:600;border-bottom:3px solid #007acc}
.total-row{font-weight:bold;color:#111;font-size:1.3rem;text-align:right;border-top:3px solid #007acc;padding-top:15px}
.footer{margin-top:60px;text-align:center;color:#111;font-size:1rem;font-weight:600}
</style>
</head>
<body>
  <div class="top-header"><span class="brand">TT World</span><div class="subtitle">Trip to the world</div><div class="section-icons"><span>Tour Packages</span><span>Flight Booking</span><span>Train Booking</span><span>Visa Services</span></div><div class="contacts"><span>www.triptotheworld.in</span> | <span>+91 72000 87875</span> | <span>soundarraj@triptotheworld.in</span></div><div class="address">13/1, Arni Road, Kosapet, Vellore</div></div></div>
  <div class="yellow-bar"><span>TRIP COSTS</span></div>
  <div class="selected-list">
    <h3>Selected Items</h3>
    ${tableRows}
    <div class="total-row">${totalText}</div>
  </div>
  <div class="footer">Travel far to find yourself ‚Äî TT World
  </div>
</body>
</html>
  `);
  previewWindow.document.close();
}

window.onload = function() { showTrips(); };
</script>   <!-- closes the JS tag only here -->
</body>
</html>







